import{a as Be}from"./chunk-UVFUWZSE.js";import{a as Se}from"./chunk-ZHXSHU6C.js";import{C as Ie,E as be,b as pe,d as ue,f as v,i as fe,j as ve,o as ge,r as _e,s as xe,t as he,u as Ce,v as Ee}from"./chunk-KCCW6LK5.js";import{a as se}from"./chunk-KV7E3DUU.js";import{$a as p,Dc as re,Fc as ae,Gc as le,Ja as r,Kb as i,Lb as ee,Mb as s,Oa as y,Uc as de,Wa as ie,Wc as me,Xa as X,Xc as ce,Y as Q,Zc as te,ac as x,bc as ne,cc as C,db as l,fb as g,ga as E,ha as I,ob as n,pb as e,qb as f,ub as S,vc as oe,wb as b,xb as u}from"./chunk-MSHI2ENP.js";import{e as Te}from"./chunk-EQDQRRRY.js";var Z=Te(Be());function Ne(o,m){o&1&&(n(0,"div",23)(1,"div",24)(2,"span",25),i(3,"Loading..."),e()(),n(4,"p",26),i(5,"Loading Car information..."),e()())}function Fe(o,m){if(o&1&&(n(0,"div",27),f(1,"i",28),i(2),e()),o&2){let t=u();r(2),s(" ",t.error," ")}}function ke(o,m){o&1&&(n(0,"div",23)(1,"div",29),f(2,"i",30),n(3,"h4",31),i(4,"Deal Expired"),e(),n(5,"p"),i(6,"The deal has expired. Please contact us for more information."),e()()())}function De(o,m){if(o&1&&(n(0,"div")(1,"div",32)(2,"div",33)(3,"p")(4,"strong"),i(5,"Car ID:"),e(),i(6),e(),n(7,"p")(8,"strong"),i(9,"Make:"),e(),i(10),e(),n(11,"p")(12,"strong"),i(13,"Model:"),e(),i(14),e(),n(15,"p")(16,"strong"),i(17,"Year:"),e(),i(18),e(),n(19,"p")(20,"strong"),i(21,"Trim:"),e(),i(22),e(),n(23,"p")(24,"strong"),i(25,"Color:"),e(),i(26),e(),n(27,"p")(28,"strong"),i(29,"Body Type:"),e(),i(30),e(),n(31,"p")(32,"strong"),i(33,"Transmission:"),e(),i(34),e(),n(35,"p")(36,"strong"),i(37,"Drivetrain:"),e(),i(38),e()(),n(39,"div",33)(40,"h5"),i(41,"Technical Details"),e(),n(42,"p")(43,"strong"),i(44,"Fuel Type:"),e(),i(45),e(),n(46,"p")(47,"strong"),i(48,"VIN:"),e(),i(49),e(),n(50,"p")(51,"strong"),i(52,"Mileage:"),e(),i(53),x(54,"number"),e(),n(55,"p")(56,"strong"),i(57,"Engine Size:"),e(),i(58),e(),n(59,"p")(60,"strong"),i(61,"Doors:"),e(),i(62),e(),n(63,"p")(64,"strong"),i(65,"Car Status:"),e(),i(66),e(),n(67,"p")(68,"strong"),i(69,"Estimated Price:"),e(),i(70),x(71,"number"),e(),n(72,"p")(73,"strong"),i(74,"Created:"),e(),i(75),x(76,"date"),e()()()()),o&2){let t=u();r(6),s(" ",t.carData.id,""),r(4),s(" ",t.carData.make,""),r(4),s(" ",t.carData.model,""),r(4),s(" ",t.carData.year,""),r(4),s(" ",t.carData.trim,""),r(4),s(" ",t.carData.color,""),r(4),s(" ",t.carData.bodyType,""),r(4),s(" ",t.carData.transmission,""),r(4),s(" ",t.carData.drivetrain,""),r(7),s(" ",t.carData.fuelType,""),r(4),s(" ",t.carData.vin,""),r(4),s(" ",ne(54,17,t.carData.mileage)," miles"),r(5),s(" ",t.carData.engineSize,""),r(4),s(" ",t.carData.doors,""),r(4),s(" ",t.carData.carStatus,""),r(4),s(" $",C(71,19,t.carData.estimatedPrice,"1.2-2"),""),r(5),s(" ",C(76,22,t.carData.createdAt,"medium"),"")}}function Me(o,m){if(o&1&&(n(0,"p")(1,"strong"),i(2,"Car Name:"),e(),i(3),e()),o&2){let t=u(2);r(3),s(" ",t.proceedInfo.carName,"")}}function Oe(o,m){if(o&1&&(n(0,"p")(1,"strong"),i(2,"Model:"),e(),i(3),e()),o&2){let t=u(2);r(3),s(" ",t.proceedInfo.carModel,"")}}function Ve(o,m){if(o&1&&(n(0,"p")(1,"strong"),i(2,"Year:"),e(),i(3),e()),o&2){let t=u(2);r(3),s(" ",t.proceedInfo.carYear,"")}}function Ae(o,m){if(o&1&&(n(0,"p")(1,"strong"),i(2,"Name:"),e(),i(3),e()),o&2){let t=u(2);r(3),s(" ",t.proceedInfo.viewerName,"")}}function qe(o,m){if(o&1&&(n(0,"p")(1,"strong"),i(2,"Email:"),e(),i(3),e()),o&2){let t=u(2);r(3),s(" ",t.proceedInfo.viewerEmail,"")}}function Le(o,m){if(o&1&&(n(0,"p",45),i(1),x(2,"number"),e()),o&2){let t=u(2);r(),s(" $",C(2,1,t.proceedInfo.basePrice,"1.2-2")," ")}}function Ue(o,m){o&1&&(n(0,"p",45),i(1," $0.00 "),e())}function We(o,m){if(o&1&&(n(0,"p",45),i(1),x(2,"number"),e()),o&2){let t=u(2);r(),s(" $",C(2,1,t.proceedInfo.additionalFees,"1.2-2")," ")}}function je(o,m){o&1&&(n(0,"p",45),i(1," $0.00 "),e())}function $e(o,m){if(o&1&&(n(0,"p",46),i(1),x(2,"number"),e()),o&2){let t=u(2);r(),s(" $",C(2,1,t.proceedInfo.totalPrice,"1.2-2")," ")}}function ze(o,m){if(o&1&&(n(0,"p",46),i(1),x(2,"number"),e()),o&2){let t=u(2);r(),s(" $",C(2,1,t.proceedInfo.basePrice,"1.2-2")," ")}}function Re(o,m){o&1&&(n(0,"p",46),i(1," $0.00 "),e())}function Ge(o,m){if(o&1&&(n(0,"p"),i(1),e()),o&2){let t=u(3);r(),ee(t.proceedInfo.notes)}}function Ye(o,m){if(o&1&&(n(0,"p")(1,"small",48),i(2),e()()),o&2){let t=u(3);r(2),ee(t.proceedInfo.terms)}}function Ke(o,m){if(o&1&&(n(0,"div",47)(1,"h6"),i(2,"Additional Information"),e(),p(3,Ge,2,1,"p",19)(4,Ye,3,1,"p",19),e()),o&2){let t=u(2);r(3),l("ngIf",t.proceedInfo.notes),r(),l("ngIf",t.proceedInfo.terms)}}function He(o,m){if(o&1){let t=S();n(0,"button",49),b("click",function(){E(t);let d=u(2);return I(d.onProceed())}),i(1," Proceed "),e()}}function Je(o,m){if(o&1){let t=S();n(0,"div")(1,"div",32)(2,"div",33)(3,"h5"),i(4,"Car Information"),e(),n(5,"p")(6,"strong"),i(7,"Car UUID:"),e(),i(8),e(),p(9,Me,4,1,"p",19)(10,Oe,4,1,"p",19)(11,Ve,4,1,"p",19),e(),n(12,"div",33)(13,"h5"),i(14,"Viewer Information"),e(),n(15,"p")(16,"strong"),i(17,"Viewer UUID:"),e(),i(18),e(),p(19,Ae,4,1,"p",19)(20,qe,4,1,"p",19),e()(),f(21,"hr"),n(22,"div",34)(23,"h5",35),i(24,"Pricing Information"),e(),n(25,"div",32)(26,"div",36)(27,"div",37)(28,"h6"),i(29,"Base Price"),e(),p(30,Le,3,4,"p",38)(31,Ue,2,0,"p",38),e()(),n(32,"div",36)(33,"div",37)(34,"h6"),i(35,"Additional Fees"),e(),p(36,We,3,4,"p",38)(37,je,2,0,"p",38),e()(),n(38,"div",36)(39,"div",39)(40,"h6"),i(41,"Total Price"),e(),p(42,$e,3,4,"p",40)(43,ze,3,4,"p",40)(44,Re,2,0,"p",40),e()()()(),p(45,Ke,5,2,"div",41),n(46,"div",42),p(47,He,2,0,"button",43),n(48,"button",44),b("click",function(){E(t);let d=u();return I(d.onCancel())}),i(49," Cancel "),e()()()}if(o&2){let t=u();r(8),s(" ",t.carId,""),r(),l("ngIf",t.proceedInfo.carName),r(),l("ngIf",t.proceedInfo.carModel),r(),l("ngIf",t.proceedInfo.carYear),r(7),s(" ",t.viewerId,""),r(),l("ngIf",t.proceedInfo.viewerName),r(),l("ngIf",t.proceedInfo.viewerEmail),r(10),l("ngIf",t.proceedInfo.basePrice),r(),l("ngIf",!t.proceedInfo.basePrice),r(5),l("ngIf",t.proceedInfo.additionalFees),r(),l("ngIf",!t.proceedInfo.additionalFees),r(5),l("ngIf",t.proceedInfo.totalPrice),r(),l("ngIf",!t.proceedInfo.totalPrice&&t.proceedInfo.basePrice),r(),l("ngIf",!t.proceedInfo.totalPrice&&!t.proceedInfo.basePrice),r(),l("ngIf",t.proceedInfo.notes||t.proceedInfo.terms),r(2),l("ngIf",t.proceedInfo.totalPrice||t.proceedInfo.basePrice)}}function Qe(o,m){if(o&1){let t=S();n(0,"button",49),b("click",function(){E(t);let d=u(2);return I(d.onProceed())}),i(1),x(2,"number"),e()}if(o&2){let t=u(2);r(),s(" Proceed - $",C(2,1,t.carData.estimatedPrice,"1.2-2")," ")}}function Xe(o,m){if(o&1){let t=S();n(0,"div",42),p(1,Qe,3,4,"button",43),n(2,"button",44),b("click",function(){E(t);let d=u();return I(d.onCancel())}),i(3," Cancel "),e()()}if(o&2){let t=u();r(),l("ngIf",t.carData.estimatedPrice)}}function Ze(o,m){o&1&&(n(0,"div",23)(1,"p",48),i(2,"No Car information available."),e()())}function et(o,m){o&1&&(n(0,"div",29),f(1,"i",28),i(2," Missing required parameters. Please check your email and click on the button to proceed. "),e())}function tt(o,m){o&1&&(n(0,"p",128),i(1,"Please fill in your details to proceed with the booking"),e())}function it(o,m){o&1&&(n(0,"p",128),i(1,"Your information has been loaded from our records"),e())}function nt(o,m){o&1&&(n(0,"div",129)(1,"div",24)(2,"span",25),i(3,"Loading..."),e()(),n(4,"p",26),i(5,"Loading your information..."),e()())}function ot(o,m){o&1&&(n(0,"div",130),i(1," First name is required "),e())}function rt(o,m){o&1&&(n(0,"div",130),i(1," Last name is required "),e())}function at(o,m){o&1&&(n(0,"div",130),i(1," Gender is required "),e())}function lt(o,m){o&1&&(n(0,"div",130),i(1," Date of birth is required "),e())}function dt(o,m){o&1&&(n(0,"div",130),i(1," Valid email is required "),e())}function mt(o,m){o&1&&(n(0,"div",130),i(1," Phone number is required "),e())}function ct(o,m){o&1&&(n(0,"div",130),i(1," Address is required "),e())}function st(o,m){o&1&&(n(0,"div",130),i(1," City is required "),e())}function pt(o,m){o&1&&(n(0,"div",130),i(1," Province is required "),e())}function ut(o,m){o&1&&(n(0,"div",130),i(1," Postal code is required "),e())}function ft(o,m){o&1&&(n(0,"div",130),i(1," Meeting type is required "),e())}function vt(o,m){o&1&&(n(0,"div",130),i(1," Meeting location type is required "),e())}function gt(o,m){o&1&&(n(0,"div",130),i(1," Meeting date is required "),e())}function _t(o,m){o&1&&(n(0,"div",130),i(1," Arrival window is required "),e())}function xt(o,m){o&1&&(n(0,"div",130),i(1," You must accept the terms and conditions "),e())}function ht(o,m){o&1&&f(0,"span",131)}function Ct(o,m){if(o&1){let t=S();n(0,"div",50)(1,"div",11)(2,"div",51)(3,"div",13)(4,"div",14)(5,"h4",15),i(6,"Customer Information"),e(),p(7,tt,2,0,"p",52)(8,it,2,0,"p",52),e(),n(9,"div",16),p(10,nt,6,0,"div",53),n(11,"form",54),b("ngSubmit",function(){E(t);let d=u();return I(d.onSubmitCustomerForm())}),n(12,"div",55)(13,"div",56)(14,"h5",57),i(15,"Personal Information"),e()(),n(16,"div",36)(17,"div",58)(18,"label",59),i(19,"First Name *"),e(),f(20,"input",60),p(21,ot,2,0,"div",61),e()(),n(22,"div",36)(23,"div",58)(24,"label",62),i(25,"Last Name *"),e(),f(26,"input",63),p(27,rt,2,0,"div",61),e()(),n(28,"div",36)(29,"div",58)(30,"label",64),i(31,"Middle Name"),e(),f(32,"input",65),e()()(),n(33,"div",55)(34,"div",36)(35,"div",58)(36,"label",66),i(37,"Gender *"),e(),n(38,"select",67)(39,"option",68),i(40,"Select Gender"),e(),n(41,"option",69),i(42,"Male"),e(),n(43,"option",70),i(44,"Female"),e(),n(45,"option",71),i(46,"Other"),e()(),p(47,at,2,0,"div",61),e()(),n(48,"div",36)(49,"div",58)(50,"label",72),i(51,"Date of Birth *"),e(),f(52,"input",73),p(53,lt,2,0,"div",61),e()(),n(54,"div",36)(55,"div",58)(56,"label",74),i(57,"Email *"),e(),f(58,"input",75),p(59,dt,2,0,"div",61),e()()(),n(60,"div",55)(61,"div",56)(62,"h5",57),i(63,"Contact Information"),e()(),n(64,"div",36)(65,"div",58)(66,"label",76),i(67,"Phone *"),e(),f(68,"input",77),p(69,mt,2,0,"div",61),e()(),n(70,"div",36)(71,"div",58)(72,"label",78),i(73,"Alternate Phone"),e(),f(74,"input",79),e()(),n(75,"div",36)(76,"div",58)(77,"label",80),i(78,"Preferred Contact Time"),e(),f(79,"input",81),e()()(),n(80,"div",55)(81,"div",33)(82,"div",58)(83,"label",82),i(84,"Preferred Contact Method"),e(),n(85,"select",83)(86,"option",68),i(87,"Select Method"),e(),n(88,"option",84),i(89,"Phone"),e(),n(90,"option",85),i(91,"Email"),e(),n(92,"option",86),i(93,"SMS"),e()()()()(),n(94,"div",55)(95,"div",56)(96,"h5",57),i(97,"Address Information"),e()(),n(98,"div",33)(99,"div",58)(100,"label",87),i(101,"Address *"),e(),f(102,"input",88),p(103,ct,2,0,"div",61),e()(),n(104,"div",89)(105,"div",58)(106,"label",90),i(107,"City *"),e(),f(108,"input",91),p(109,st,2,0,"div",61),e()(),n(110,"div",89)(111,"div",58)(112,"label",92),i(113,"Province *"),e(),f(114,"input",93),p(115,pt,2,0,"div",61),e()()(),n(116,"div",55)(117,"div",36)(118,"div",58)(119,"label",94),i(120,"Postal Code *"),e(),f(121,"input",95),p(122,ut,2,0,"div",61),e()()(),n(123,"div",55)(124,"div",56)(125,"h5",57),i(126,"Meeting Information"),e()(),n(127,"div",36)(128,"div",58)(129,"label",96),i(130,"Meeting Type *"),e(),n(131,"select",97)(132,"option",68),i(133,"Select Type"),e(),n(134,"option",98),i(135,"Virtual"),e(),n(136,"option",99),i(137,"In-Person"),e()(),p(138,ft,2,0,"div",61),e()(),n(139,"div",36)(140,"div",58)(141,"label",100),i(142,"Meeting Location Type *"),e(),n(143,"select",101)(144,"option",68),i(145,"Select Location"),e(),n(146,"option",102),i(147,"Office"),e(),n(148,"option",103),i(149,"Branch"),e(),n(150,"option",71),i(151,"Other"),e()(),p(152,vt,2,0,"div",61),e()(),n(153,"div",36)(154,"div",58)(155,"label",104),i(156,"Meeting Date *"),e(),f(157,"input",105),p(158,gt,2,0,"div",61),e()()(),n(159,"div",55)(160,"div",36)(161,"div",58)(162,"label",106),i(163,"Arrival Window *"),e(),n(164,"select",107)(165,"option",68),i(166,"Select Arrival Window"),e(),n(167,"option",108),i(168,"10->12 Morning"),e(),n(169,"option",109),i(170,"12->3 Noon"),e(),n(171,"option",110),i(172,"3-6 Afternoon"),e(),n(173,"option",111),i(174,"6->9 Night"),e()(),p(175,_t,2,0,"div",61),e()(),n(176,"div",36)(177,"div",58)(178,"label",112),i(179,"Meeting Branch"),e(),f(180,"input",113),e()()(),n(181,"div",55)(182,"div",33)(183,"div",58)(184,"label",114),i(185,"Meeting Address"),e(),f(186,"input",115),e()()(),n(187,"div",55)(188,"div",56)(189,"h5",57),i(190,"Additional Information"),e()(),n(191,"div",116)(192,"div",58)(193,"label",117),i(194,"Additional Notes"),e(),f(195,"textarea",118),e()()(),n(196,"div",55)(197,"div",116)(198,"div",58)(199,"label",119),i(200,"Meeting Notes"),e(),f(201,"textarea",120),e()()(),n(202,"div",55)(203,"div",56)(204,"div",121),f(205,"input",122),n(206,"label",123),i(207," I accept the terms and conditions * "),e(),p(208,xt,2,0,"div",61),e()()(),n(209,"div",32)(210,"div",124)(211,"button",125),b("click",function(){E(t);let d=u();return I(d.onBackToBooking())}),i(212," Back to Booking "),e(),n(213,"button",126),p(214,ht,1,0,"span",127),i(215),e()()()()()()()()()}if(o&2){let t,c,d,h,_,P,w,T,B,N,F,k,D,M,O,V,A,q,L,U,W,j,$,z,R,G,Y,K,H,J,a=u();r(7),l("ngIf",!a.viewerData),r(),l("ngIf",a.viewerData),r(2),l("ngIf",a.loadingViewerData),r(),l("formGroup",a.customerForm),r(9),g("is-invalid",((t=a.customerForm.get("firstName"))==null?null:t.invalid)&&((t=a.customerForm.get("firstName"))==null?null:t.touched)),l("disabled",a.viewerData),r(),l("ngIf",((c=a.customerForm.get("firstName"))==null?null:c.invalid)&&((c=a.customerForm.get("firstName"))==null?null:c.touched)),r(5),g("is-invalid",((d=a.customerForm.get("lastName"))==null?null:d.invalid)&&((d=a.customerForm.get("lastName"))==null?null:d.touched)),l("disabled",a.viewerData),r(),l("ngIf",((h=a.customerForm.get("lastName"))==null?null:h.invalid)&&((h=a.customerForm.get("lastName"))==null?null:h.touched)),r(11),g("is-invalid",((_=a.customerForm.get("gender"))==null?null:_.invalid)&&((_=a.customerForm.get("gender"))==null?null:_.touched)),r(9),l("ngIf",((P=a.customerForm.get("gender"))==null?null:P.invalid)&&((P=a.customerForm.get("gender"))==null?null:P.touched)),r(5),g("is-invalid",((w=a.customerForm.get("dateOfBirth"))==null?null:w.invalid)&&((w=a.customerForm.get("dateOfBirth"))==null?null:w.touched)),l("max",a.maxDateOfBirth),r(),l("ngIf",((T=a.customerForm.get("dateOfBirth"))==null?null:T.invalid)&&((T=a.customerForm.get("dateOfBirth"))==null?null:T.touched)),r(5),g("is-invalid",((B=a.customerForm.get("email"))==null?null:B.invalid)&&((B=a.customerForm.get("email"))==null?null:B.touched)),l("disabled",a.viewerData),r(),l("ngIf",((N=a.customerForm.get("email"))==null?null:N.invalid)&&((N=a.customerForm.get("email"))==null?null:N.touched)),r(9),g("is-invalid",((F=a.customerForm.get("phone"))==null?null:F.invalid)&&((F=a.customerForm.get("phone"))==null?null:F.touched)),l("disabled",a.viewerData),r(),l("ngIf",((k=a.customerForm.get("phone"))==null?null:k.invalid)&&((k=a.customerForm.get("phone"))==null?null:k.touched)),r(33),g("is-invalid",((D=a.customerForm.get("address"))==null?null:D.invalid)&&((D=a.customerForm.get("address"))==null?null:D.touched)),r(),l("ngIf",((M=a.customerForm.get("address"))==null?null:M.invalid)&&((M=a.customerForm.get("address"))==null?null:M.touched)),r(5),g("is-invalid",((O=a.customerForm.get("city"))==null?null:O.invalid)&&((O=a.customerForm.get("city"))==null?null:O.touched)),r(),l("ngIf",((V=a.customerForm.get("city"))==null?null:V.invalid)&&((V=a.customerForm.get("city"))==null?null:V.touched)),r(5),g("is-invalid",((A=a.customerForm.get("province"))==null?null:A.invalid)&&((A=a.customerForm.get("province"))==null?null:A.touched)),r(),l("ngIf",((q=a.customerForm.get("province"))==null?null:q.invalid)&&((q=a.customerForm.get("province"))==null?null:q.touched)),r(6),g("is-invalid",((L=a.customerForm.get("postalCode"))==null?null:L.invalid)&&((L=a.customerForm.get("postalCode"))==null?null:L.touched)),r(),l("ngIf",((U=a.customerForm.get("postalCode"))==null?null:U.invalid)&&((U=a.customerForm.get("postalCode"))==null?null:U.touched)),r(9),g("is-invalid",((W=a.customerForm.get("meetingType"))==null?null:W.invalid)&&((W=a.customerForm.get("meetingType"))==null?null:W.touched)),r(7),l("ngIf",((j=a.customerForm.get("meetingType"))==null?null:j.invalid)&&((j=a.customerForm.get("meetingType"))==null?null:j.touched)),r(5),g("is-invalid",(($=a.customerForm.get("meetingLocationType"))==null?null:$.invalid)&&(($=a.customerForm.get("meetingLocationType"))==null?null:$.touched)),r(9),l("ngIf",((z=a.customerForm.get("meetingLocationType"))==null?null:z.invalid)&&((z=a.customerForm.get("meetingLocationType"))==null?null:z.touched)),r(5),g("is-invalid",((R=a.customerForm.get("meetingDate"))==null?null:R.invalid)&&((R=a.customerForm.get("meetingDate"))==null?null:R.touched)),l("min",a.minMeetingDate),r(),l("ngIf",((G=a.customerForm.get("meetingDate"))==null?null:G.invalid)&&((G=a.customerForm.get("meetingDate"))==null?null:G.touched)),r(6),g("is-invalid",((Y=a.customerForm.get("arrivalWindow"))==null?null:Y.invalid)&&((Y=a.customerForm.get("arrivalWindow"))==null?null:Y.touched)),r(11),l("ngIf",((K=a.customerForm.get("arrivalWindow"))==null?null:K.invalid)&&((K=a.customerForm.get("arrivalWindow"))==null?null:K.touched)),r(30),g("is-invalid",((H=a.customerForm.get("acceptTermsAndConditions"))==null?null:H.invalid)&&((H=a.customerForm.get("acceptTermsAndConditions"))==null?null:H.touched)),r(3),l("ngIf",((J=a.customerForm.get("acceptTermsAndConditions"))==null?null:J.invalid)&&((J=a.customerForm.get("acceptTermsAndConditions"))==null?null:J.touched)),r(5),l("disabled",a.submitting),r(),l("ngIf",a.submitting),r(),s(" ",a.submitting?"Submitting...":"Submit Information"," ")}}var Pe=(()=>{class o{constructor(t,c,d,h){this.route=t,this.router=c,this.apiService=d,this.fb=h,this.routes=se,this.viewerId=null,this.carId=null,this.proceedInfo=null,this.carData=null,this.viewerData=null,this.isNewCustomer=null,this.dealExpired=!1,this.loading=!1,this.error=null,this.showCustomerForm=!1,this.submitting=!1,this.loadingViewerData=!1,this.customerForm=this.createCustomerForm(),this.initializeDateConstraints()}ngOnInit(){this.route.queryParamMap.subscribe(t=>{this.viewerId=t.get("viewer"),this.carId=t.get("car")}),this.viewerId&&this.carId&&this.checkAlreadyUsed()}initializeDateConstraints(){let t=new Date,c=new Date(t);c.setDate(c.getDate()+1),this.maxDateOfBirth=t.toISOString().split("T")[0],this.minMeetingDate=c.toISOString().split("T")[0]}checkAlreadyUsed(){if(this.viewerId&&this.carId){this.loading=!0,this.error=null;let t={carUUID:this.carId,viewerUUID:this.viewerId};this.apiService.proceedInfo(t).subscribe({next:c=>{this.proceedInfo=c,c?(this.isNewCustomer=c.responseData.isNewCustomer,this.isNewCustomer?this.getCarData():(this.dealExpired=!0,this.loading=!1)):this.loading=!1},error:c=>{this.error="Failed to load proceed information",this.loading=!1,console.error("Error loading proceed info:",c)}})}}getCarData(){this.carId&&this.apiService.getCarByUUID(this.carId).subscribe({next:t=>{this.carData=t[0],this.loading=!1},error:t=>{this.error="Failed to load car information",this.loading=!1,console.error("Error loading car data:",t)}})}createCustomerForm(){return this.fb.group({firstName:["",[v.required]],lastName:["",[v.required]],middleName:[""],gender:["",[v.required]],dateOfBirth:["",[v.required]],email:["",[v.required,v.email]],phone:["",[v.required]],alternatePhone:[""],address:["",[v.required]],city:["",[v.required]],province:["",[v.required]],postalCode:["",[v.required]],preferredContactTime:[""],preferredContactMethod:[""],additionalNotes:[""],acceptTermsAndConditions:[!1,[v.requiredTrue]],meetingType:["",[v.required]],meetingLocationType:["",[v.required]],meetingAddress:[""],meetingBranch:[""],meetingDate:["",[v.required]],arrivalWindow:["",[v.required]],isMeetingConfirmed:[!1],meetingNotes:[""]})}onCancel(){this.router.navigate([this.routes.homeNew])}onProceed(){this.viewerId?(this.loadingViewerData=!0,this.error=null,this.apiService.getViewerByUUID(this.viewerId).subscribe({next:t=>{this.viewerData=t,this.loadingViewerData=!1,this.showCustomerForm=!0,this.populateFormWithViewerData()},error:t=>{this.loadingViewerData=!1,this.error="Failed to load viewer information",console.error("Error loading viewer data:",t),this.showCustomerForm=!0}})):this.showCustomerForm=!0}onSubmitCustomerForm(){if(this.customerForm.valid&&this.viewerId){this.submitting=!0;let t=this.customerForm.getRawValue(),c={viewerId:this.viewerId,carId:this.carId,firstName:t.firstName,lastName:t.lastName,middleName:t.middleName,gender:t.gender,dateOfBirth:t.dateOfBirth,email:t.email,phone:t.phone,alternatePhone:t.alternatePhone,address:t.address,city:t.city,province:t.province,postalCode:t.postalCode,preferredContactTime:t.preferredContactTime,preferredContactMethod:t.preferredContactMethod,additionalNotes:t.additionalNotes,acceptTermsAndConditions:t.acceptTermsAndConditions,meetingType:t.meetingType,meetingLocationType:t.meetingLocationType,meetingAddress:t.meetingAddress,meetingBranch:t.meetingBranch,meetingDate:t.meetingDate,arrivalWindow:t.arrivalWindow,isMeetingConfirmed:t.isMeetingConfirmed,meetingNotes:t.meetingNotes},d=new FormData,h=new Blob([JSON.stringify(c)],{type:"application/json"});d.append("customer",h),this.apiService.proceedToCustomer(d).subscribe({next:_=>{this.submitting=!1,console.log("Customer data submitted successfully:",_),Z.default.fire({title:"Success!",text:"Customer information submitted successfully! We will contact you soon to schedule your meeting.",icon:"success",confirmButtonText:"OK",confirmButtonColor:"#28a745"}),this.router.navigate([this.routes.homeNew])},error:_=>{this.submitting=!1,this.error="Failed to submit customer information: "+(_.errorDescription||_.message||"Unknown error"),console.error("Error submitting customer data:",_),Z.default.fire({title:"Error!",text:"Failed to submit customer information. Please try again.",icon:"error",confirmButtonText:"OK",confirmButtonColor:"#dc3545"})}})}else Object.keys(this.customerForm.controls).forEach(t=>{this.customerForm.get(t)?.markAsTouched()}),Z.default.fire({title:"Validation Error",text:"Please fill in all mandatory fields before submitting.",icon:"warning",confirmButtonText:"OK",confirmButtonColor:"#007bff"})}onBackToBooking(){this.showCustomerForm=!1}populateFormWithViewerData(){if(this.viewerData){let t=this.viewerData.responseData||this.viewerData;this.customerForm.patchValue({firstName:t.firstName||t.first_name||"",lastName:t.lastName||t.last_name||"",middleName:t.middleName||t.middle_name||"",gender:t.gender||"",dateOfBirth:t.dateOfBirth||t.date_of_birth||"",email:t.email||"",phone:t.phone||t.phoneNumber||"",alternatePhone:t.alternatePhone||t.alternate_phone||"",address:t.address||"",city:t.city||"",province:t.province||t.state||"",postalCode:t.postalCode||t.postal_code||t.zipCode||"",preferredContactTime:t.preferredContactTime||t.preferred_contact_time||"",preferredContactMethod:t.preferredContactMethod||t.preferred_contact_method||"",additionalNotes:t.additionalNotes||t.additional_notes||""}),this.customerForm.get("firstName")?.disable(),this.customerForm.get("lastName")?.disable(),this.customerForm.get("email")?.disable(),this.customerForm.get("phone")?.disable()}}static{this.\u0275fac=function(c){return new(c||o)(y(de),y(me),y(Se),y(Ie))}}static{this.\u0275cmp=ie({type:o,selectors:[["app-proceed-booking"]],standalone:!1,decls:30,vars:10,consts:[[1,"breadcrumb-bar"],[1,"container"],[1,"row","align-items-center","text-center"],[1,"col-md-12","col-12"],[1,"breadcrumb-title"],["aria-label","breadcrumb",1,"page-breadcrumb"],[1,"breadcrumb"],[1,"breadcrumb-item"],[3,"routerLink"],["aria-current","page",1,"breadcrumb-item","active"],[1,"container",2,"margin-top","50px"],[1,"row","justify-content-center"],[1,"col-md-8"],[1,"card"],[1,"card-header"],[1,"card-title","mb-0"],[1,"card-body"],["class","text-center",4,"ngIf"],["class","alert alert-danger","role","alert",4,"ngIf"],[4,"ngIf"],["class","mt-4 text-center",4,"ngIf"],["class","alert alert-warning","role","alert",4,"ngIf"],["class","container","style","margin-top: 30px;",4,"ngIf"],[1,"text-center"],["role","status",1,"spinner-border","text-primary"],[1,"sr-only"],[1,"mt-2"],["role","alert",1,"alert","alert-danger"],[1,"fas","fa-exclamation-triangle"],["role","alert",1,"alert","alert-warning"],[1,"fas","fa-clock"],[1,"alert-heading"],[1,"row"],[1,"col-md-6"],[1,"price-section"],[1,"text-primary"],[1,"col-md-4"],[1,"price-card"],["class","price-amount",4,"ngIf"],[1,"price-card","total-price"],["class","price-amount total",4,"ngIf"],["class","mt-4",4,"ngIf"],[1,"mt-4","text-center"],["class","btn btn-primary btn-lg me-3",3,"click",4,"ngIf"],[1,"btn","btn-secondary","btn-lg",3,"click"],[1,"price-amount"],[1,"price-amount","total"],[1,"mt-4"],[1,"text-muted"],[1,"btn","btn-primary","btn-lg","me-3",3,"click"],[1,"container",2,"margin-top","30px"],[1,"col-md-10"],["class","text-muted mb-0",4,"ngIf"],["class","text-center mb-4",4,"ngIf"],[3,"ngSubmit","formGroup"],[1,"row","mb-4"],[1,"col-12"],[1,"text-primary","mb-3"],[1,"form-group"],["for","firstName"],["type","text","id","firstName","formControlName","firstName",1,"form-control",3,"disabled"],["class","invalid-feedback",4,"ngIf"],["for","lastName"],["type","text","id","lastName","formControlName","lastName",1,"form-control",3,"disabled"],["for","middleName"],["type","text","id","middleName","formControlName","middleName",1,"form-control"],["for","gender"],["id","gender","formControlName","gender",1,"form-control"],["value",""],["value","Male"],["value","Female"],["value","Other"],["for","dateOfBirth"],["type","date","id","dateOfBirth","formControlName","dateOfBirth",1,"form-control",3,"max"],["for","email"],["type","email","id","email","formControlName","email",1,"form-control",3,"disabled"],["for","phone"],["type","tel","id","phone","formControlName","phone",1,"form-control",3,"disabled"],["for","alternatePhone"],["type","tel","id","alternatePhone","formControlName","alternatePhone",1,"form-control"],["for","preferredContactTime"],["type","text","id","preferredContactTime","formControlName","preferredContactTime","placeholder","e.g., 09:00 - 11:00",1,"form-control"],["for","preferredContactMethod"],["id","preferredContactMethod","formControlName","preferredContactMethod",1,"form-control"],["value","Phone"],["value","Email"],["value","SMS"],["for","address"],["type","text","id","address","formControlName","address",1,"form-control"],[1,"col-md-3"],["for","city"],["type","text","id","city","formControlName","city",1,"form-control"],["for","province"],["type","text","id","province","formControlName","province",1,"form-control"],["for","postalCode"],["type","text","id","postalCode","formControlName","postalCode",1,"form-control"],["for","meetingType"],["id","meetingType","formControlName","meetingType",1,"form-control"],["value","Virtual"],["value","In-Person"],["for","meetingLocationType"],["id","meetingLocationType","formControlName","meetingLocationType",1,"form-control"],["value","Office"],["value","Branch"],["for","meetingDate"],["type","date","id","meetingDate","formControlName","meetingDate",1,"form-control",3,"min"],["for","arrivalWindow"],["id","arrivalWindow","formControlName","arrivalWindow",1,"form-control"],["value","10->12 morning"],["value","12->3 noon"],["value","3-6 afternoon"],["value","6->9 night"],["for","meetingBranch"],["type","text","id","meetingBranch","formControlName","meetingBranch",1,"form-control"],["for","meetingAddress"],["type","text","id","meetingAddress","formControlName","meetingAddress",1,"form-control"],[1,"col-md-12"],["for","additionalNotes"],["id","additionalNotes","formControlName","additionalNotes","rows","3",1,"form-control"],["for","meetingNotes"],["id","meetingNotes","formControlName","meetingNotes","rows","3",1,"form-control"],[1,"form-check"],["type","checkbox","id","acceptTermsAndConditions","formControlName","acceptTermsAndConditions",1,"form-check-input"],["for","acceptTermsAndConditions",1,"form-check-label"],[1,"col-12","text-center"],["type","button",1,"btn","btn-secondary","btn-lg","me-3",3,"click"],["type","submit",1,"btn","btn-primary","btn-lg",3,"disabled"],["class","spinner-border spinner-border-sm me-2","role","status",4,"ngIf"],[1,"text-muted","mb-0"],[1,"text-center","mb-4"],[1,"invalid-feedback"],["role","status",1,"spinner-border","spinner-border-sm","me-2"]],template:function(c,d){c&1&&(n(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"h2",4),i(5,"Details"),e(),n(6,"nav",5)(7,"ol",6)(8,"li",7)(9,"a",8),i(10,"Home"),e()(),n(11,"li",9),i(12," Proceed Sell Your Car "),e()()()()()()(),n(13,"div",10)(14,"div",11)(15,"div",12)(16,"div",13)(17,"div",14)(18,"h4",15),i(19,"Car Information"),e()(),n(20,"div",16),p(21,Ne,6,0,"div",17)(22,Fe,3,1,"div",18)(23,ke,7,0,"div",17)(24,De,77,25,"div",19)(25,Je,50,16,"div",19)(26,Xe,4,1,"div",20)(27,Ze,3,0,"div",17)(28,et,3,0,"div",21),e()()()()(),p(29,Ct,216,58,"div",22)),c&2&&(r(9),l("routerLink",d.routes.homeNew),r(12),l("ngIf",d.loading),r(),l("ngIf",d.error&&!d.loading),r(),l("ngIf",d.dealExpired&&!d.loading&&!d.error),r(),l("ngIf",d.carData&&!d.loading&&!d.error&&d.isNewCustomer),r(),l("ngIf",d.proceedInfo&&!d.carData&&!d.dealExpired&&!d.loading&&!d.error),r(),l("ngIf",d.carData&&!d.loading&&!d.error&&d.isNewCustomer),r(),l("ngIf",!d.proceedInfo&&!d.loading&&!d.error&&d.viewerId&&d.carId),r(),l("ngIf",!d.viewerId||!d.carId),r(),l("ngIf",d.showCustomerForm))},dependencies:[oe,ce,ge,Ce,Ee,ue,pe,he,fe,ve,_e,xe,ae,re],styles:[".price-section[_ngcontent-%COMP%]{background-color:#f8f9fa;padding:20px;border-radius:8px;margin:20px 0}.price-card[_ngcontent-%COMP%]{text-align:center;padding:15px;background-color:#fff;border-radius:6px;box-shadow:0 2px 4px #0000001a;margin-bottom:10px}.price-card.total-price[_ngcontent-%COMP%]{background-color:#e3f2fd;border:2px solid #2196f3}.price-card[_ngcontent-%COMP%]   h6[_ngcontent-%COMP%]{color:#666;margin-bottom:10px;font-weight:600}.price-amount[_ngcontent-%COMP%]{font-size:1.5rem;font-weight:700;color:#333;margin:0}.price-amount.total[_ngcontent-%COMP%]{color:#2196f3;font-size:1.8rem}.card[_ngcontent-%COMP%]{box-shadow:0 4px 6px #0000001a;border:none}.card-header[_ngcontent-%COMP%]{background-color:#f8f9fa;border-bottom:1px solid #dee2e6}.spinner-border[_ngcontent-%COMP%]{width:3rem;height:3rem}.alert[_ngcontent-%COMP%]{border-radius:6px}.btn-lg[_ngcontent-%COMP%]{padding:12px 30px;font-size:1.1rem}"]})}}return o})();var Et=[{path:"",component:Pe}],we=(()=>{class o{static{this.\u0275fac=function(c){return new(c||o)}}static{this.\u0275mod=X({type:o})}static{this.\u0275inj=Q({imports:[te.forChild(Et),te]})}}return o})();var At=(()=>{class o{static{this.\u0275fac=function(c){return new(c||o)}}static{this.\u0275mod=X({type:o})}static{this.\u0275inj=Q({imports:[le,we,be]})}}return o})();export{At as ProceedBookingModule};
