import{a as P}from"./chunk-K7ACIKUK.js";import{a as tt}from"./chunk-ZHXSHU6C.js";import{F as K,G as Q,N as X,O as Z,wd as $}from"./chunk-2BYPWJHQ.js";import"./chunk-WACMVKXJ.js";import"./chunk-2QSN2QZ4.js";import"./chunk-G2XYFENO.js";import{a as j}from"./chunk-A6GTVXL6.js";import{b as R,d as U,i as Y,n as G,t as H,u as J,v as q}from"./chunk-KCCW6LK5.js";import{a as O}from"./chunk-KV7E3DUU.js";import{$a as w,Gc as L,Ja as d,Kb as r,Lb as y,Mb as v,Oa as b,Ob as N,Qb as _,Rb as S,Sb as D,Ub as x,Wa as I,Wc as W,Xa as M,Xc as B,Y as E,Zc as k,db as m,ga as u,ha as f,ob as i,pb as n,qb as p,tc as z,ub as A,uc as F,vc as V,wb as c,xb as h}from"./chunk-MSHI2ENP.js";import"./chunk-EQDQRRRY.js";var T=()=>({standalone:!0});function nt(s,C){s&1&&(i(0,"div",35)(1,"div",36)(2,"span",37),r(3,"Loading..."),n()(),i(4,"p",38),r(5,"Loading data..."),n()())}function rt(s,C){if(s&1&&(i(0,"div",39),p(1,"i",40),r(2),n()),s&2){let t=h();d(2),v(" ",t.errorMessage," ")}}function ot(s,C){s&1&&(i(0,"div",35),p(1,"i",41),i(2,"p",42),r(3,"No data found"),n()())}function st(s,C){if(s&1){let t=A();i(0,"tr")(1,"td")(2,"div",56)(3,"input",57),D("ngModelChange",function(e){let o=u(t).$implicit;return S(o.isSelected,e)||(o.isSelected=e),f(e)}),c("ngModelChange",function(){let e=u(t).$implicit,o=h(2);return f(o.selectItem(e))}),n()()(),i(4,"td")(5,"div",58)(6,"div")(7,"h6",59),r(8),n()()()(),i(9,"td"),r(10),n(),i(11,"td"),r(12),n(),i(13,"td"),r(14),n(),i(15,"td")(16,"span",60),r(17),n()(),i(18,"td"),r(19),n(),i(20,"td")(21,"span",60),r(22),n()(),i(23,"td")(24,"div",61)(25,"a",62),p(26,"i",63),n(),i(27,"ul",64)(28,"li")(29,"a",65),c("click",function(){let e=u(t).$implicit,o=h(2);return f(o.navigateToCarDetails(e,"view"))}),p(30,"i",66),r(31,"View Details"),n()(),i(32,"li")(33,"a",65),c("click",function(){let e=u(t).$implicit,o=h(2);return f(o.navigateToCarDetails(e,"edit"))}),p(34,"i",67),r(35,"Edit"),n()()()()()()}if(s&2){let t=C.$implicit;d(3),_("ngModel",t.isSelected),d(5),y(t.car),d(2),y(t.carType),d(2),y(t.price),d(2),v("",t.damages," miles"),d(2),m("ngClass",t.isFilled?"bg-success":"bg-warning"),d(),v(" ",t.isFilled?"Yes":"No"," "),d(2),y(t.createdDate),d(2),m("ngClass",t.status==="NEW"?"bg-success":t.status==="PENDING"?"bg-warning":"bg-danger"),d(),v(" ",t.status," ")}}function lt(s,C){if(s&1){let t=A();i(0,"table",43),c("matSortChange",function(e){u(t);let o=h();return f(o.sortData(e))}),i(1,"thead",44)(2,"tr")(3,"th",45)(4,"div",46),c("click",function(){u(t);let e=h();return f(e.selectAll(e.initChecked))}),i(5,"input",47),D("ngModelChange",function(e){u(t);let o=h();return S(o.initChecked,e)||(o.initChecked=e),f(e)}),n()()(),i(6,"th",48),r(7,"CAR"),n(),i(8,"th",49),r(9,"BODY TYPE"),n(),i(10,"th",50),r(11,"ESTIMATED PRICE"),n(),i(12,"th",51),r(13,"MILEAGE"),n(),i(14,"th",52),r(15,"IS PRICED"),n(),i(16,"th",53),r(17,"CREATED DATE"),n(),i(18,"th",54),r(19,"STATUS"),n(),p(20,"th"),n()(),i(21,"tbody"),w(22,st,36,10,"tr",55),n()()}if(s&2){let t=h();d(5),_("ngModel",t.initChecked),d(17),m("ngForOf",t.tableData)}}function dt(s,C){if(s&1&&(i(0,"span"),r(1),n()),s&2){let t=h();d(),N(" Showing ",t.currentPage*t.pageSize+1," to ",t.Math.min((t.currentPage+1)*t.pageSize,t.totalData)," of ",t.totalData," entries ")}}function mt(s,C){s&1&&(i(0,"span"),r(1,"No entries found"),n())}var it=(()=>{class s{convertDateFormat(t){if(!t||t.trim()==="")return"";let a=t.split("-");return a.length===3?`${a[2]}/${a[1]}/${a[0]}`:t}constructor(t,a,e,o){this.data=t,this.router=a,this.pagination=e,this.apiService=o,this.routes=O,this.initChecked=!1,this.pageSize=5,this.tableData=[],this.tableDataCopy=[],this.actualData=[],this.currentPage=0,this.skip=0,this.limit=this.pageSize,this.serialNumberArray=[],this.totalData=0,this.showFilter=!1,this.pageSelection=[],this.searchDataValue="",this.sortBy="Descending",this.fromDate="",this.toDate="",this.status="",this.isLoading=!1,this.errorMessage="",this.hasError=!1,this.originalApiData=[],this.totalPages=0,this.Math=Math,this.isUpdatingPagination=!1,this.pagination.tablePageSize.subscribe(l=>{if(this.isUpdatingPagination)return;let g=Math.floor(l.skip/this.pageSize);g!==this.currentPage&&g>=0&&(this.currentPage=g,this.loadData())})}ngOnInit(){this.loadData()}getTableData(t){this.currentPage=Math.floor(t.skip/this.pageSize),this.loadData()}loadData(){this.isLoading=!0,this.hasError=!1,this.errorMessage="";let t={page:this.currentPage,sortBy:this.sortBy||"Descending",fromDate:this.convertDateFormat(this.fromDate),toDate:this.convertDateFormat(this.toDate),status:this.status,pageSize:this.pageSize};this.apiService.getCarsFilter(t).subscribe({next:a=>{this.isLoading=!1,this.tableData=[],this.tableDataCopy=[],this.serialNumberArray=[],a&&Array.isArray(a)?(this.actualData=a,this.originalApiData=a,a.forEach((e,o)=>{let l=this.currentPage*this.pageSize+o+1,g={sNo:l,id:e.id,car:`${e.make||""} ${e.model||""}`.trim()||"N/A",carType:e.bodyType||"N/A",baseLocation:e.color||"N/A",price:e.estimatedPrice?`$${e.estimatedPrice.toFixed(2)}`:"N/A",damages:e.mileage||0,isFilled:e.isPriced==="Y",createdDate:e.createdAt?new Date(e.createdAt).toLocaleDateString():"N/A",status:e.carStatus||"N/A",image:"car-list-1.jpg",isSelected:!1,originalData:e};this.tableData.push(g),this.tableDataCopy.push(g),this.serialNumberArray.push(l)}),this.fetchTotalCount(),this.dataSource=new P(this.tableData),this.isUpdatingPagination=!0,this.pagination.calculatePageSize.next({totalData:this.totalData,pageSize:this.pageSize,tableData:this.tableData,serialNumberArray:this.serialNumberArray}),this.skip=this.currentPage*this.pageSize,this.pagination.tablePageSize.next({skip:this.skip,limit:this.limit,pageSize:this.pageSize}),setTimeout(()=>{this.isUpdatingPagination=!1},0)):(this.totalData=0,this.actualData=[],this.originalApiData=[],this.dataSource=new P([]),this.isUpdatingPagination=!0,this.pagination.calculatePageSize.next({totalData:0,pageSize:this.pageSize,tableData:[],serialNumberArray:[]}),this.skip=this.currentPage*this.pageSize,this.pagination.tablePageSize.next({skip:this.skip,limit:this.limit,pageSize:this.pageSize}),setTimeout(()=>{this.isUpdatingPagination=!1},0))},error:a=>{this.isLoading=!1,this.hasError=!0,this.errorMessage="Failed to load cars data. Please try again.",this.totalData=0,this.actualData=[],this.originalApiData=[],this.dataSource=new P([]),console.error("Error loading cars data:",a)}})}searchData(t){t==""?this.tableData=this.tableDataCopy:(this.dataSource.filter=t.trim().toLowerCase(),this.tableData=this.dataSource.filteredData)}sortData(t){let a=this.tableData.slice();!t.active||t.direction===""?this.tableData=a:this.tableData=a.sort((e,o)=>{let l=e[t.active],g=o[t.active];return(l<g?-1:1)*(t.direction==="asc"?1:-1)})}changePageSize(t){this.pageSelection=[];let a=Math.min(t,5);this.limit=a,this.skip=0,this.currentPage=0,this.pageSize=a,this.loadData()}onPageChange(t){this.currentPage=t,this.loadData()}applyFilters(){this.currentPage=0,this.loadData()}clearFilters(){this.sortBy="Descending",this.fromDate="",this.toDate="",this.status="",this.currentPage=0,this.loadData()}fetchTotalCount(){let t={page:0,sortBy:this.sortBy||"Descending",fromDate:this.convertDateFormat(this.fromDate),toDate:this.convertDateFormat(this.toDate),status:this.status,pageSize:1e4};this.apiService.getCarsFilter(t).subscribe({next:a=>{a&&Array.isArray(a)&&(this.totalData=a.length,this.pagination.calculatePageSize.next({totalData:this.totalData,pageSize:this.pageSize,tableData:this.tableData,serialNumberArray:this.serialNumberArray}))},error:a=>{console.error("Error fetching total count:",a),this.totalData=this.tableData.length}})}onSortChange(t){this.sortBy=t,this.currentPage=0,this.loadData()}onStatusChange(t){this.status=t,this.currentPage=0,this.loadData()}onDateChange(){this.currentPage=0,this.loadData()}onDateRangeChange(t,a){this.fromDate=t,this.toDate=a,this.currentPage=0,this.loadData()}navigateToCarDetails(t,a){let e=t.originalData||this.originalApiData.find(o=>o.id===t.id);if(e&&e.id){let o={originalData:e};sessionStorage.setItem("currentCarData",JSON.stringify(o)),this.router.navigate(["/admin/car-details-edit",e.id.toString(),a])}else console.error("Car data not found for navigation")}selectItem(t){}deleteCar(t){console.log("Delete car:",t)}onPageSizeChange(t){this.pageSize=Math.min(t,5),this.currentPage=0,this.loadData()}selectAll(t){t?this.tableData.forEach(a=>{a.isSelected=!1}):this.tableData.forEach(a=>{a.isSelected=!0})}static{this.\u0275fac=function(a){return new(a||s)(b(j),b(W),b(X),b(tt))}}static{this.\u0275cmp=I({type:s,selectors:[["app-cars"]],standalone:!1,decls:63,vars:19,consts:[[1,"content","me-4"],[1,"d-md-flex","d-block","align-items-center","justify-content-between","page-breadcrumb","mb-3"],[1,"my-auto","mb-2"],[1,"mb-1"],[1,"breadcrumb","mb-0"],[1,"breadcrumb-item"],[3,"routerLink"],["aria-current","page",1,"breadcrumb-item","active"],[1,"filter-form","mb-3","p-3","bg-light","rounded"],[1,"row","g-3","align-items-end"],[1,"col-md-3"],[1,"form-label"],["type","date",1,"form-control",3,"ngModelChange","change","ngModel","ngModelOptions"],[1,"col-md-2"],[1,"form-select",3,"ngModelChange","ngModel","ngModelOptions"],["value","Descending"],["value","Ascending"],["value",""],["value","NEW"],["value","PENDING"],["value","ACTIVE"],["value","INACTIVE"],[1,"col-md-1"],["type","button",1,"btn","btn-primary","w-100",3,"click"],[1,"ti","ti-search","me-1"],["type","button",1,"btn","btn-secondary","w-100",3,"click"],[1,"ti","ti-x","me-1"],[1,"custom-datatable-filter","table-responsive"],["class","text-center p-4",4,"ngIf"],["class","alert alert-danger text-center p-4",4,"ngIf"],["matSort","","class","table datatable",3,"matSortChange",4,"ngIf"],[1,"d-flex","justify-content-between","align-items-center","mt-3"],[1,"dataTables_info"],[4,"ngIf"],[1,"dataTables_paginate"],[1,"text-center","p-4"],["role","status",1,"spinner-border","text-primary"],[1,"visually-hidden"],[1,"mt-2"],[1,"alert","alert-danger","text-center","p-4"],[1,"ti","ti-alert-circle","me-2"],[1,"ti","ti-database-off","text-muted",2,"font-size","3rem"],[1,"mt-2","text-muted"],["matSort","",1,"table","datatable",3,"matSortChange"],[1,"thead-light"],[1,"no-sort"],[1,"form-check","form-check-md",3,"click"],["type","checkbox","id","select-all",1,"form-check-input",3,"ngModelChange","ngModel"],["mat-sort-header","car"],["mat-sort-header","location"],["mat-sort-header","price"],["mat-sort-header","damage"],["mat-sort-header","feature"],["mat-sort-header","date"],["mat-sort-header","status"],[4,"ngFor","ngForOf"],[1,"form-check","form-check-md"],["type","checkbox",1,"form-check-input",3,"ngModelChange","ngModel"],[1,"d-flex","align-items-center"],[1,"mb-0"],[1,"badge",3,"ngClass"],[1,"dropdown"],["href","javascript:void(0);","data-bs-toggle","dropdown",1,"btn","btn-white","btn-sm"],[1,"ti","ti-dots-vertical"],[1,"dropdown-menu"],["href","javascript:void(0);",1,"dropdown-item","rounded-1",3,"click"],[1,"ti","ti-eye","me-1"],[1,"ti","ti-edit","me-1"]],template:function(a,e){a&1&&(i(0,"div",0)(1,"div",1)(2,"div",2)(3,"h4",3),r(4,"All Cars"),n(),i(5,"nav")(6,"ol",4)(7,"li",5)(8,"a",6),r(9,"Home"),n()(),i(10,"li",7),r(11,"All Cars"),n()()()()(),i(12,"div",8)(13,"div",9)(14,"div",10)(15,"label",11),r(16,"From Date"),n(),i(17,"input",12),D("ngModelChange",function(l){return S(e.fromDate,l)||(e.fromDate=l),l}),c("change",function(){return e.onDateChange()}),n()(),i(18,"div",10)(19,"label",11),r(20,"To Date"),n(),i(21,"input",12),D("ngModelChange",function(l){return S(e.toDate,l)||(e.toDate=l),l}),c("change",function(){return e.onDateChange()}),n()(),i(22,"div",13)(23,"label",11),r(24,"Sort By"),n(),i(25,"select",14),D("ngModelChange",function(l){return S(e.sortBy,l)||(e.sortBy=l),l}),c("ngModelChange",function(l){return e.onSortChange(l)}),i(26,"option",15),r(27,"Descending"),n(),i(28,"option",16),r(29,"Ascending"),n()()(),i(30,"div",13)(31,"label",11),r(32,"Status"),n(),i(33,"select",14),D("ngModelChange",function(l){return S(e.status,l)||(e.status=l),l}),c("ngModelChange",function(l){return e.onStatusChange(l)}),i(34,"option",17),r(35,"All"),n(),i(36,"option",18),r(37,"New"),n(),i(38,"option",19),r(39,"Pending"),n(),i(40,"option",20),r(41,"Active"),n(),i(42,"option",21),r(43,"Inactive"),n()()(),i(44,"div",22)(45,"button",23),c("click",function(){return e.applyFilters()}),p(46,"i",24),r(47," Search "),n()(),i(48,"div",22)(49,"button",25),c("click",function(){return e.clearFilters()}),p(50,"i",26),r(51," Clear "),n()()()(),i(52,"div",27),w(53,nt,6,0,"div",28)(54,rt,3,1,"div",29)(55,ot,4,0,"div",28)(56,lt,23,2,"table",30),n(),i(57,"div",31)(58,"div",32),w(59,dt,2,3,"span",33)(60,mt,2,0,"span",33),n(),i(61,"div",34),p(62,"app-custom-pagination"),n()()()),a&2&&(d(8),m("routerLink",e.routes.homeNew),d(9),_("ngModel",e.fromDate),m("ngModelOptions",x(15,T)),d(4),_("ngModel",e.toDate),m("ngModelOptions",x(16,T)),d(4),_("ngModel",e.sortBy),m("ngModelOptions",x(17,T)),d(8),_("ngModel",e.status),m("ngModelOptions",x(18,T)),d(20),m("ngIf",e.isLoading),d(),m("ngIf",e.hasError),d(),m("ngIf",!e.isLoading&&!e.hasError&&e.totalData===0),d(),m("ngIf",!e.isLoading&&!e.hasError&&e.totalData>0),d(3),m("ngIf",e.totalData>0),d(),m("ngIf",e.totalData===0))},dependencies:[z,F,V,B,J,q,U,R,H,Y,G,K,Q,Z],encapsulation:2})}}return s})();var ct=[{path:"",component:it}],at=(()=>{class s{static{this.\u0275fac=function(a){return new(a||s)}}static{this.\u0275mod=M({type:s})}static{this.\u0275inj=E({imports:[k.forChild(ct),k]})}}return s})();var kt=(()=>{class s{static{this.\u0275fac=function(a){return new(a||s)}}static{this.\u0275mod=M({type:s})}static{this.\u0275inj=E({imports:[L,at,$]})}}return s})();export{kt as CarsModule};
