import{a as i}from"./chunk-KV7E3DUU.js";import{Wc as s,X as n,_ as a}from"./chunk-MSHI2ENP.js";var f=(()=>{class t{constructor(e){this.router=e}isTokenExpired(e){try{let r=e.split(".");if(r.length!==3)return!0;let o=JSON.parse(atob(r[1]));if(!o.exp)return!0;let u=o.exp*1e3;return Date.now()>=u}catch{return!0}}isAuthenticated(){let e=localStorage.getItem("authToken");return e?this.isTokenExpired(e)?(this.clearAuth(),!1):!0:!1}getToken(){return localStorage.getItem("authToken")}setToken(e){localStorage.setItem("authToken",e)}setUsername(e){sessionStorage.setItem("otpUsername",e)}getUsername(){return sessionStorage.getItem("otpUsername")}setUserInfo(e){localStorage.setItem("userInfo",JSON.stringify(e))}getUserInfo(){let e=localStorage.getItem("userInfo");return e?JSON.parse(e):null}logout(){localStorage.removeItem("authToken"),localStorage.removeItem("userInfo"),sessionStorage.removeItem("otpUsername"),this.router.navigate([i.adminlogin])}clearAuth(){localStorage.removeItem("authToken"),localStorage.removeItem("userInfo"),sessionStorage.removeItem("otpUsername")}static{this.\u0275fac=function(r){return new(r||t)(a(s))}}static{this.\u0275prov=n({token:t,factory:t.\u0275fac,providedIn:"root"})}}return t})();export{f as a};
