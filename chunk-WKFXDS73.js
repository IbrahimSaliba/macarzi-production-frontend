import{a as M}from"./chunk-K7ACIKUK.js";import{a as ee}from"./chunk-ZHXSHU6C.js";import{F as Q,G as X,N as Y,O as Z,wd as $}from"./chunk-2BYPWJHQ.js";import"./chunk-WACMVKXJ.js";import"./chunk-2QSN2QZ4.js";import"./chunk-G2XYFENO.js";import{a as j}from"./chunk-A6GTVXL6.js";import{b as R,d as U,i as G,n as H,t as J,u as q,v as K}from"./chunk-KCCW6LK5.js";import{a as B}from"./chunk-KV7E3DUU.js";import{$a as x,Gc as F,Ja as d,Kb as r,Lb as u,Mb as N,Oa as v,Ob as T,Qb as _,Rb as b,Sb as D,Ub as C,Wa as I,Wc as W,Xa as E,Xc as O,Y as y,Zc as A,db as m,ga as f,ha as S,ob as i,pb as a,qb as c,tc as k,ub as P,uc as z,vc as L,wb as p,xb as g}from"./chunk-MSHI2ENP.js";import"./chunk-EQDQRRRY.js";var V=()=>({standalone:!0});function ne(o,w){o&1&&(i(0,"div",32)(1,"div",33)(2,"span",34),r(3,"Loading..."),a()(),i(4,"p",35),r(5,"Loading data..."),a()())}function re(o,w){if(o&1&&(i(0,"div",36),c(1,"i",37),r(2),a()),o&2){let e=g();d(2),N(" ",e.errorMessage," ")}}function oe(o,w){o&1&&(i(0,"div",32),c(1,"i",38),i(2,"p",39),r(3,"No data found"),a()())}function se(o,w){if(o&1){let e=P();i(0,"tr")(1,"td")(2,"div",53)(3,"input",54),D("ngModelChange",function(t){let l=f(e).$implicit;return b(l.isSelected,t)||(l.isSelected=t),S(t)}),p("ngModelChange",function(){let t=f(e).$implicit,l=g(2);return S(l.selectItem(t))}),a()()(),i(4,"td")(5,"div",55)(6,"div",56)(7,"span",57),r(8),a()(),i(9,"div")(10,"h6",58),r(11),a()()()(),i(12,"td"),r(13),a(),i(14,"td"),r(15),a(),i(16,"td"),r(17),a(),i(18,"td"),r(19),a(),i(20,"td"),r(21),a(),i(22,"td")(23,"span",59),r(24),a()(),i(25,"td")(26,"div",60)(27,"a",61),c(28,"i",62),a(),i(29,"ul",63)(30,"li")(31,"a",64),p("click",function(){let t=f(e).$implicit,l=g(2);return S(l.navigateToViewerDetails(t,"view"))}),c(32,"i",65),r(33,"View Details"),a()()()()()()}if(o&2){let e=w.$implicit;d(3),_("ngModel",e.isSelected),d(5),u(e.car.charAt(0)),d(3),u(e.car),d(2),u(e.carType),d(2),u(e.price),d(2),u(e.baseLocation),d(2),u(e.damages),d(2),u(e.createdDate),d(2),m("ngClass",e.status==="NEW"?"bg-success":e.status==="PENDING"?"bg-warning":"bg-danger"),d(),N(" ",e.status," ")}}function le(o,w){if(o&1){let e=P();i(0,"table",40),p("matSortChange",function(t){f(e);let l=g();return S(l.sortData(t))}),i(1,"thead",41)(2,"tr")(3,"th",42)(4,"div",43),p("click",function(){f(e);let t=g();return S(t.selectAll(t.initChecked))}),i(5,"input",44),D("ngModelChange",function(t){f(e);let l=g();return b(l.initChecked,t)||(l.initChecked=t),S(t)}),a()()(),i(6,"th",45),r(7,"VIEWER NAME"),a(),i(8,"th",46),r(9,"PLATE NUMBER"),a(),i(10,"th",47),r(11,"VIN NUMBER"),a(),i(12,"th",48),r(13,"POSTAL CODE"),a(),i(14,"th",49),r(15,"EMAIL"),a(),i(16,"th",50),r(17,"CREATED DATE"),a(),i(18,"th",51),r(19,"STATUS"),a(),c(20,"th"),a()(),i(21,"tbody"),x(22,se,34,10,"tr",52),a()()}if(o&2){let e=g();d(5),_("ngModel",e.initChecked),d(17),m("ngForOf",e.tableData)}}function de(o,w){if(o&1&&(i(0,"div",66)(1,"div",67),r(2),a(),i(3,"div",68),c(4,"app-custom-pagination"),a()()),o&2){let e=g();d(2),T(" Showing ",e.currentPage*e.pageSize+1," to ",e.Math.min((e.currentPage+1)*e.pageSize,e.totalData)," of ",e.totalData," entries ")}}var ie=(()=>{class o{convertDateFormat(e){if(!e)return"";let n=e.split("-");return n.length===3?`${n[2]}/${n[1]}/${n[0]}`:e}constructor(e,n,t,l){this.data=e,this.router=n,this.pagination=t,this.apiService=l,this.routes=B,this.initChecked=!1,this.pageSize=5,this.tableData=[],this.tableDataCopy=[],this.actualData=[],this.currentPage=0,this.skip=0,this.limit=this.pageSize,this.serialNumberArray=[],this.totalData=0,this.showFilter=!1,this.pageSelection=[],this.searchDataValue="",this.sortBy="",this.fromDate="",this.toDate="",this.status="",this.isLoading=!1,this.errorMessage="",this.hasError=!1,this.originalApiData=[],this.totalPages=0,this.Math=Math,this.isUpdatingPagination=!1,this.pagination.tablePageSize.subscribe(s=>{if(this.isUpdatingPagination)return;let h=Math.floor(s.skip/this.pageSize);h!==this.currentPage&&h>=0&&(this.currentPage=h,this.loadData())})}ngOnInit(){this.loadData()}getTableData(e){this.currentPage=Math.floor(e.skip/this.pageSize),this.loadData()}loadData(){this.isLoading=!0,this.hasError=!1,this.errorMessage="";let e={page:this.currentPage,sortBy:this.sortBy||"Descending",fromDate:this.convertDateFormat(this.fromDate),toDate:this.convertDateFormat(this.toDate),status:this.status,pageSize:this.pageSize};this.apiService.getViewersFilter(e).subscribe({next:n=>{this.isLoading=!1,this.tableData=[],this.tableDataCopy=[],this.serialNumberArray=[],n&&n.data&&Array.isArray(n.data)?(this.totalData=n.totalCount||n.data.length,this.actualData=n.data,this.originalApiData=n.data,n.data.forEach((t,l)=>{let s=this.currentPage*this.pageSize+l+1,h={sNo:s,id:t.id,car:`${t.firstName||""} ${t.lastName||""}`.trim()||"N/A",carType:t.plateNumber||"N/A",baseLocation:t.postalCode||"N/A",price:t.vinNumber||"N/A",damages:t.email||"N/A",isFilled:!1,createdDate:t.createdAt?new Date(t.createdAt).toLocaleDateString():"N/A",status:t.viewerStatus||"N/A",image:"car-list-1.jpg",isSelected:!1,originalData:t};this.tableData.push(h),this.tableDataCopy.push(h),this.serialNumberArray.push(s)}),this.dataSource=new M(this.tableData),this.isUpdatingPagination=!0,this.pagination.calculatePageSize.next({totalData:this.totalData,pageSize:this.pageSize,tableData:this.tableData,serialNumberArray:this.serialNumberArray}),this.skip=this.currentPage*this.pageSize,this.pagination.tablePageSize.next({skip:this.skip,limit:this.limit,pageSize:this.pageSize}),setTimeout(()=>{this.isUpdatingPagination=!1},0)):(this.totalData=0,this.actualData=[],this.originalApiData=[],this.dataSource=new M([]),this.isUpdatingPagination=!0,this.pagination.calculatePageSize.next({totalData:0,pageSize:this.pageSize,tableData:[],serialNumberArray:[]}),this.skip=this.currentPage*this.pageSize,this.pagination.tablePageSize.next({skip:this.skip,limit:this.limit,pageSize:this.pageSize}),setTimeout(()=>{this.isUpdatingPagination=!1},0))},error:n=>{this.isLoading=!1,this.hasError=!0,this.errorMessage="Failed to load viewers data. Please try again.",this.totalData=0,this.actualData=[],this.originalApiData=[],this.dataSource=new M([]),console.error("Error loading viewers data:",n)}})}searchData(e){e==""?this.tableData=this.tableDataCopy:(this.dataSource.filter=e.trim().toLowerCase(),this.tableData=this.dataSource.filteredData)}sortData(e){let n=this.tableData.slice();!e.active||e.direction===""?this.tableData=n:this.tableData=n.sort((t,l)=>{let s=t[e.active],h=l[e.active];return(s<h?-1:1)*(e.direction==="asc"?1:-1)})}changePageSize(e){this.pageSelection=[];let n=Math.min(e,5);this.limit=n,this.skip=0,this.currentPage=0,this.pageSize=n,this.loadData()}onPageChange(e){this.currentPage=e,this.loadData()}applyFilters(){this.currentPage=0,this.loadData()}clearFilters(){this.sortBy="",this.fromDate="",this.toDate="",this.status="",this.currentPage=0,this.loadData()}onSortChange(e){e!==null&&(this.sortBy=e,this.currentPage=0,this.loadData())}onStatusChange(e){this.status=e||"",this.currentPage=0,this.loadData()}navigateToViewerDetails(e,n){if(e.originalData){let t={tableData:e,originalData:e.originalData};sessionStorage.setItem("currentViewerData",JSON.stringify(t)),this.router.navigate(["/admin/viewer-details-edit",e.id||e.originalData.id,n])}else sessionStorage.setItem("currentViewerData",JSON.stringify(e)),this.router.navigate(["/admin/viewer-details-edit",e.id||e.sNo,n])}selectItem(e){}deleteViewer(e){console.log("Delete viewer:",e)}onPageSizeChange(e){this.pageSize=Math.min(e,5),this.currentPage=0,this.loadData()}selectAll(e){e?this.tableData.forEach(n=>{n.isSelected=!1}):this.tableData.forEach(n=>{n.isSelected=!0})}static{this.\u0275fac=function(n){return new(n||o)(v(j),v(W),v(Y),v(ee))}}static{this.\u0275cmp=I({type:o,selectors:[["app-viewers"]],standalone:!1,decls:60,vars:18,consts:[[1,"content","me-4"],[1,"d-md-flex","d-block","align-items-center","justify-content-between","page-breadcrumb","mb-3"],[1,"my-auto","mb-2"],[1,"mb-1"],[1,"breadcrumb","mb-0"],[1,"breadcrumb-item"],[3,"routerLink"],["aria-current","page",1,"breadcrumb-item","active"],[1,"filter-form","mb-3","p-3","bg-light","rounded"],[1,"row","g-3","align-items-end"],[1,"col-md-3"],[1,"form-label"],["type","date",1,"form-control",3,"ngModelChange","ngModel","ngModelOptions"],[1,"col-md-2"],[1,"form-select",3,"ngModelChange","change","ngModel","ngModelOptions"],["value","Descending"],["value","Ascending"],["value",""],["value","NEW"],["value","PENDING"],["value","ACTIVE"],["value","INACTIVE"],["value","CONFIRMED"],["type","button",1,"btn","btn-primary","w-100",3,"click"],[1,"ti","ti-search","me-1"],["type","button",1,"btn","btn-secondary","w-100",3,"click"],[1,"ti","ti-x","me-1"],[1,"custom-datatable-filter","table-responsive"],["class","text-center p-4",4,"ngIf"],["class","alert alert-danger text-center p-4",4,"ngIf"],["matSort","","class","table datatable",3,"matSortChange",4,"ngIf"],["class","d-flex justify-content-between align-items-center mt-3",4,"ngIf"],[1,"text-center","p-4"],["role","status",1,"spinner-border","text-primary"],[1,"visually-hidden"],[1,"mt-2"],[1,"alert","alert-danger","text-center","p-4"],[1,"ti","ti-alert-circle","me-2"],[1,"ti","ti-database-off","text-muted",2,"font-size","3rem"],[1,"mt-2","text-muted"],["matSort","",1,"table","datatable",3,"matSortChange"],[1,"thead-light"],[1,"no-sort"],[1,"form-check","form-check-md",3,"click"],["type","checkbox","id","select-all",1,"form-check-input",3,"ngModelChange","ngModel"],["mat-sort-header","car"],["mat-sort-header","location"],["mat-sort-header","price"],["mat-sort-header","damage"],["mat-sort-header","feature"],["mat-sort-header","date"],["mat-sort-header","status"],[4,"ngFor","ngForOf"],[1,"form-check","form-check-md"],["type","checkbox",1,"form-check-input",3,"ngModelChange","ngModel"],[1,"d-flex","align-items-center"],[1,"avatar","avatar-sm","me-2"],[1,"avatar-initial","rounded-circle","bg-primary","w-100","d-flex","align-items-center","justify-content-center"],[1,"mb-0"],[1,"badge",3,"ngClass"],[1,"dropdown"],["href","javascript:void(0);","data-bs-toggle","dropdown",1,"btn","btn-white","btn-sm"],[1,"ti","ti-dots-vertical"],[1,"dropdown-menu"],["href","javascript:void(0);",1,"dropdown-item","rounded-1",3,"click"],[1,"ti","ti-eye","me-1"],[1,"d-flex","justify-content-between","align-items-center","mt-3"],[1,"dataTables_info"],[1,"dataTables_paginate"]],template:function(n,t){n&1&&(i(0,"div",0)(1,"div",1)(2,"div",2)(3,"h4",3),r(4,"All Viewers"),a(),i(5,"nav")(6,"ol",4)(7,"li",5)(8,"a",6),r(9,"Home"),a()(),i(10,"li",7),r(11,"All Viewers"),a()()()()(),i(12,"div",8)(13,"div",9)(14,"div",10)(15,"label",11),r(16,"From Date"),a(),i(17,"input",12),D("ngModelChange",function(s){return b(t.fromDate,s)||(t.fromDate=s),s}),a()(),i(18,"div",10)(19,"label",11),r(20,"To Date"),a(),i(21,"input",12),D("ngModelChange",function(s){return b(t.toDate,s)||(t.toDate=s),s}),a()(),i(22,"div",13)(23,"label",11),r(24,"Sort By"),a(),i(25,"select",14),D("ngModelChange",function(s){return b(t.sortBy,s)||(t.sortBy=s),s}),p("change",function(s){return t.onSortChange(s.target.value)}),i(26,"option",15),r(27,"Descending"),a(),i(28,"option",16),r(29,"Ascending"),a()()(),i(30,"div",13)(31,"label",11),r(32,"Status"),a(),i(33,"select",14),D("ngModelChange",function(s){return b(t.status,s)||(t.status=s),s}),p("change",function(s){return t.onStatusChange(s.target.value)}),i(34,"option",17),r(35,"All"),a(),i(36,"option",18),r(37,"New"),a(),i(38,"option",19),r(39,"Pending"),a(),i(40,"option",20),r(41,"Active"),a(),i(42,"option",21),r(43,"Inactive"),a(),i(44,"option",22),r(45,"Confirmed"),a()()(),i(46,"div",13)(47,"button",23),p("click",function(){return t.applyFilters()}),c(48,"i",24),r(49," Search "),a()(),i(50,"div",13)(51,"button",25),p("click",function(){return t.clearFilters()}),c(52,"i",26),r(53," Clear "),a()()()(),i(54,"div",27),x(55,ne,6,0,"div",28)(56,re,3,1,"div",29)(57,oe,4,0,"div",28)(58,le,23,2,"table",30),a(),x(59,de,5,3,"div",31),a()),n&2&&(d(8),m("routerLink",t.routes.homeNew),d(9),_("ngModel",t.fromDate),m("ngModelOptions",C(14,V)),d(4),_("ngModel",t.toDate),m("ngModelOptions",C(15,V)),d(4),_("ngModel",t.sortBy),m("ngModelOptions",C(16,V)),d(8),_("ngModel",t.status),m("ngModelOptions",C(17,V)),d(22),m("ngIf",t.isLoading),d(),m("ngIf",t.hasError),d(),m("ngIf",!t.isLoading&&!t.hasError&&t.totalData===0),d(),m("ngIf",!t.isLoading&&!t.hasError&&t.totalData>0),d(),m("ngIf",!t.isLoading&&!t.hasError&&t.totalData>0))},dependencies:[k,z,L,O,q,K,U,R,J,G,H,Q,X,Z],encapsulation:2})}}return o})();var me=[{path:"",component:ie}],ae=(()=>{class o{static{this.\u0275fac=function(n){return new(n||o)}}static{this.\u0275mod=E({type:o})}static{this.\u0275inj=y({imports:[A.forChild(me),A]})}}return o})();var Ne=(()=>{class o{static{this.\u0275fac=function(n){return new(n||o)}}static{this.\u0275mod=E({type:o})}static{this.\u0275inj=y({imports:[F,ae,$]})}}return o})();export{Ne as ViewersModule};
