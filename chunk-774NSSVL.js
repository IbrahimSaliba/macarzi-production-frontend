import{a as w}from"./chunk-K7ACIKUK.js";import{a as tt}from"./chunk-ZHXSHU6C.js";import{F as K,G as Q,N as X,O as Z,wd as $}from"./chunk-2BYPWJHQ.js";import"./chunk-WACMVKXJ.js";import"./chunk-2QSN2QZ4.js";import"./chunk-G2XYFENO.js";import{a as B}from"./chunk-A6GTVXL6.js";import{b as U,d as R,i as H,n as G,t as J,u as Y,v as q}from"./chunk-KCCW6LK5.js";import{a as j}from"./chunk-KV7E3DUU.js";import{$a as M,Gc as F,Ja as m,Kb as r,Lb as g,Mb as A,Oa as v,Ob as k,Qb as S,Rb as _,Sb as b,Ub as y,Wa as T,Wc as W,Xa as x,Xc as O,Y as E,Zc as I,db as d,ga as f,ha as C,ob as i,pb as a,qb as p,tc as z,ub as P,uc as V,vc as L,wb as u,xb as c}from"./chunk-MSHI2ENP.js";import"./chunk-EQDQRRRY.js";var N=()=>({standalone:!0});function nt(o,D){o&1&&(i(0,"div",32)(1,"div",33)(2,"span",34),r(3,"Loading..."),a()(),i(4,"p",35),r(5,"Loading data..."),a()())}function rt(o,D){if(o&1&&(i(0,"div",36),p(1,"i",37),r(2),a()),o&2){let t=c();m(2),A(" ",t.errorMessage," ")}}function ot(o,D){o&1&&(i(0,"div",32),p(1,"i",38),i(2,"p",39),r(3,"No data found"),a()())}function st(o,D){if(o&1){let t=P();i(0,"tr")(1,"td")(2,"div",53)(3,"input",54),b("ngModelChange",function(e){let l=f(t).$implicit;return _(l.isSelected,e)||(l.isSelected=e),C(e)}),u("ngModelChange",function(){let e=f(t).$implicit,l=c(2);return C(l.selectItem(e))}),a()()(),i(4,"td")(5,"div",55)(6,"div",56)(7,"span",57),r(8),a()(),i(9,"div")(10,"h6",58),r(11),a()()()(),i(12,"td"),r(13),a(),i(14,"td"),r(15),a(),i(16,"td"),r(17),a(),i(18,"td"),r(19),a(),i(20,"td"),r(21),a(),i(22,"td")(23,"span",59),r(24),a()(),i(25,"td")(26,"div",60)(27,"a",61),p(28,"i",62),a(),i(29,"ul",63)(30,"li")(31,"a",64),u("click",function(){let e=f(t).$implicit,l=c(2);return C(l.navigateToCustomerDetails(e,"view"))}),p(32,"i",65),r(33,"View Details"),a()()()()()()}if(o&2){let t=D.$implicit,n=c(2);m(3),S("ngModel",t.isSelected),m(5),g(t.fullName.charAt(0)),m(3),g(t.fullName),m(2),g(t.email),m(2),g(t.phone),m(2),g(t.city),m(2),g(t.province),m(2),g(t.createdDate),m(2),d("ngClass",n.getStatusClass(t.status)),m(),A(" ",t.status," ")}}function lt(o,D){if(o&1){let t=P();i(0,"table",40),u("matSortChange",function(e){f(t);let l=c();return C(l.sortData(e))}),i(1,"thead",41)(2,"tr")(3,"th",42)(4,"div",43),u("click",function(){f(t);let e=c();return C(e.selectAll(e.initChecked))}),i(5,"input",44),b("ngModelChange",function(e){f(t);let l=c();return _(l.initChecked,e)||(l.initChecked=e),C(e)}),a()()(),i(6,"th",45),r(7,"CUSTOMER NAME"),a(),i(8,"th",46),r(9,"EMAIL"),a(),i(10,"th",47),r(11,"PHONE"),a(),i(12,"th",48),r(13,"CITY"),a(),i(14,"th",49),r(15,"PROVINCE"),a(),i(16,"th",50),r(17,"CREATED DATE"),a(),i(18,"th",51),r(19,"STATUS"),a(),p(20,"th"),a()(),i(21,"tbody"),M(22,st,34,10,"tr",52),a()()}if(o&2){let t=c();m(5),S("ngModel",t.initChecked),m(17),d("ngForOf",t.tableData)}}function mt(o,D){if(o&1&&(i(0,"div",66)(1,"div",67),r(2),a(),i(3,"div",68),p(4,"app-custom-pagination"),a()()),o&2){let t=c();m(2),k(" Showing ",t.currentPage*t.pageSize+1," to ",t.Math.min((t.currentPage+1)*t.pageSize,t.totalData)," of ",t.totalData," entries ")}}var it=(()=>{class o{convertDateFormat(t){if(!t)return"";let n=t.split("-");return n.length===3?`${n[2]}/${n[1]}/${n[0]}`:t}constructor(t,n,e,l){this.data=t,this.router=n,this.pagination=e,this.apiService=l,this.routes=j,this.initChecked=!1,this.pageSize=5,this.tableData=[],this.tableDataCopy=[],this.actualData=[],this.currentPage=0,this.skip=0,this.limit=this.pageSize,this.serialNumberArray=[],this.totalData=0,this.showFilter=!1,this.pageSelection=[],this.searchDataValue="",this.sortBy="",this.fromDate="",this.toDate="",this.status="",this.isLoading=!1,this.errorMessage="",this.hasError=!1,this.originalApiData=[],this.totalPages=0,this.Math=Math,this.isUpdatingPagination=!1,this.pagination.tablePageSize.subscribe(s=>{if(this.isUpdatingPagination)return;let h=Math.floor(s.skip/this.pageSize);h!==this.currentPage&&h>=0&&(this.currentPage=h,this.loadData())})}ngOnInit(){this.loadData()}getTableData(t){this.currentPage=Math.floor(t.skip/this.pageSize),this.loadData()}loadData(){this.isLoading=!0,this.hasError=!1,this.errorMessage="";let t={page:this.currentPage,sortBy:this.sortBy||"Descending",fromDate:this.convertDateFormat(this.fromDate),toDate:this.convertDateFormat(this.toDate),status:this.status,pageSize:this.pageSize};this.apiService.getCustomersFilter(t).subscribe({next:n=>{this.isLoading=!1,this.tableData=[],this.tableDataCopy=[],this.serialNumberArray=[],n&&n.data&&Array.isArray(n.data)?(this.totalData=n.totalCount||n.data.length,this.actualData=n.data,this.originalApiData=n.data,n.data.forEach((e,l)=>{let s=this.currentPage*this.pageSize+l+1,h={sNo:s,id:e.id,firstName:e.firstName||"",lastName:e.lastName||"",fullName:`${e.firstName||""} ${e.lastName||""}`.trim()||"N/A",email:e.email||"N/A",phone:e.phone||"N/A",address:e.address||"N/A",city:e.city||"N/A",province:e.province||"N/A",postalCode:e.postalCode||"N/A",status:e.status||"N/A",isVerified:e.isVerified,createdDate:e.createdAt?new Date(e.createdAt).toLocaleDateString():"N/A",isSelected:!1,originalData:e};this.tableData.push(h),this.tableDataCopy.push(h),this.serialNumberArray.push(s)}),this.dataSource=new w(this.tableData),this.isUpdatingPagination=!0,this.pagination.calculatePageSize.next({totalData:this.totalData,pageSize:this.pageSize,tableData:this.tableData,serialNumberArray:this.serialNumberArray}),this.skip=this.currentPage*this.pageSize,this.pagination.tablePageSize.next({skip:this.skip,limit:this.limit,pageSize:this.pageSize}),setTimeout(()=>{this.isUpdatingPagination=!1},0)):(this.totalData=0,this.actualData=[],this.originalApiData=[],this.dataSource=new w([]),this.isUpdatingPagination=!0,this.pagination.calculatePageSize.next({totalData:0,pageSize:this.pageSize,tableData:[],serialNumberArray:[]}),this.skip=this.currentPage*this.pageSize,this.pagination.tablePageSize.next({skip:this.skip,limit:this.limit,pageSize:this.pageSize}),setTimeout(()=>{this.isUpdatingPagination=!1},0))},error:n=>{this.isLoading=!1,this.hasError=!0,this.errorMessage="Failed to load customers data. Please try again.",this.totalData=0,this.actualData=[],this.originalApiData=[],this.dataSource=new w([]),console.error("Error loading customers data:",n)}})}searchData(t){t==""?this.tableData=this.tableDataCopy:(this.dataSource.filter=t.trim().toLowerCase(),this.tableData=this.dataSource.filteredData)}sortData(t){let n=this.tableData.slice();!t.active||t.direction===""?this.tableData=n:this.tableData=n.sort((e,l)=>{let s=e[t.active],h=l[t.active];return(s<h?-1:1)*(t.direction==="asc"?1:-1)})}changePageSize(t){this.pageSelection=[];let n=Math.min(t,5);this.limit=n,this.skip=0,this.currentPage=0,this.pageSize=n,this.loadData()}onPageChange(t){this.currentPage=t,this.loadData()}applyFilters(){this.currentPage=0,this.loadData()}clearFilters(){this.sortBy="",this.fromDate="",this.toDate="",this.status="",this.currentPage=0,this.loadData()}onSortChange(t){t!==null&&(this.sortBy=t,this.currentPage=0,this.loadData())}onStatusChange(t){this.status=t||"",this.currentPage=0,this.loadData()}navigateToCustomerDetails(t,n){if(t.originalData){let e={tableData:t,originalData:t.originalData};sessionStorage.setItem("currentCustomerData",JSON.stringify(e)),this.router.navigate(["/admin/customer-details",t.id||t.originalData.id,n])}else sessionStorage.setItem("currentCustomerData",JSON.stringify(t)),this.router.navigate(["/admin/customer-details",t.id||t.sNo,n])}selectItem(t){}deleteCustomer(t){console.log("Delete customer:",t)}onPageSizeChange(t){this.pageSize=Math.min(t,5),this.currentPage=0,this.loadData()}selectAll(t){t?this.tableData.forEach(n=>{n.isSelected=!1}):this.tableData.forEach(n=>{n.isSelected=!0})}getStatusClass(t){switch(t?.toUpperCase()){case"NEW":return"bg-info";case"ACTIVE":return"bg-success";case"PENDING":return"bg-warning";case"INACTIVE":return"bg-secondary";case"COMPLETED":return"bg-primary";default:return"bg-secondary"}}static{this.\u0275fac=function(n){return new(n||o)(v(B),v(W),v(X),v(tt))}}static{this.\u0275cmp=T({type:o,selectors:[["app-customers"]],standalone:!1,decls:60,vars:18,consts:[[1,"content","me-4"],[1,"d-md-flex","d-block","align-items-center","justify-content-between","page-breadcrumb","mb-3"],[1,"my-auto","mb-2"],[1,"mb-1"],[1,"breadcrumb","mb-0"],[1,"breadcrumb-item"],[3,"routerLink"],["aria-current","page",1,"breadcrumb-item","active"],[1,"filter-form","mb-3","p-3","bg-light","rounded"],[1,"row","g-3","align-items-end"],[1,"col-md-3"],[1,"form-label"],["type","date",1,"form-control",3,"ngModelChange","ngModel","ngModelOptions"],[1,"col-md-2"],[1,"form-select",3,"ngModelChange","change","ngModel","ngModelOptions"],["value","Descending"],["value","Ascending"],["value",""],["value","NEW"],["value","ACTIVE"],["value","PENDING"],["value","INACTIVE"],["value","COMPLETED"],["type","button",1,"btn","btn-primary","w-100",3,"click"],[1,"ti","ti-search","me-1"],["type","button",1,"btn","btn-secondary","w-100",3,"click"],[1,"ti","ti-x","me-1"],[1,"custom-datatable-filter","table-responsive"],["class","text-center p-4",4,"ngIf"],["class","alert alert-danger text-center p-4",4,"ngIf"],["matSort","","class","table datatable",3,"matSortChange",4,"ngIf"],["class","d-flex justify-content-between align-items-center mt-3",4,"ngIf"],[1,"text-center","p-4"],["role","status",1,"spinner-border","text-primary"],[1,"visually-hidden"],[1,"mt-2"],[1,"alert","alert-danger","text-center","p-4"],[1,"ti","ti-alert-circle","me-2"],[1,"ti","ti-database-off","text-muted",2,"font-size","3rem"],[1,"mt-2","text-muted"],["matSort","",1,"table","datatable",3,"matSortChange"],[1,"thead-light"],[1,"no-sort"],[1,"form-check","form-check-md",3,"click"],["type","checkbox","id","select-all",1,"form-check-input",3,"ngModelChange","ngModel"],["mat-sort-header","fullName"],["mat-sort-header","email"],["mat-sort-header","phone"],["mat-sort-header","city"],["mat-sort-header","province"],["mat-sort-header","createdDate"],["mat-sort-header","status"],[4,"ngFor","ngForOf"],[1,"form-check","form-check-md"],["type","checkbox",1,"form-check-input",3,"ngModelChange","ngModel"],[1,"d-flex","align-items-center"],[1,"avatar","avatar-sm","me-2"],[1,"avatar-initial","rounded-circle","bg-primary","w-100","d-flex","align-items-center","justify-content-center"],[1,"mb-0"],[1,"badge",3,"ngClass"],[1,"dropdown"],["href","javascript:void(0);","data-bs-toggle","dropdown",1,"btn","btn-white","btn-sm"],[1,"ti","ti-dots-vertical"],[1,"dropdown-menu"],["href","javascript:void(0);",1,"dropdown-item","rounded-1",3,"click"],[1,"ti","ti-eye","me-1"],[1,"d-flex","justify-content-between","align-items-center","mt-3"],[1,"dataTables_info"],[1,"dataTables_paginate"]],template:function(n,e){n&1&&(i(0,"div",0)(1,"div",1)(2,"div",2)(3,"h4",3),r(4,"All Customers"),a(),i(5,"nav")(6,"ol",4)(7,"li",5)(8,"a",6),r(9,"Home"),a()(),i(10,"li",7),r(11,"All Customers"),a()()()()(),i(12,"div",8)(13,"div",9)(14,"div",10)(15,"label",11),r(16,"From Date"),a(),i(17,"input",12),b("ngModelChange",function(s){return _(e.fromDate,s)||(e.fromDate=s),s}),a()(),i(18,"div",10)(19,"label",11),r(20,"To Date"),a(),i(21,"input",12),b("ngModelChange",function(s){return _(e.toDate,s)||(e.toDate=s),s}),a()(),i(22,"div",13)(23,"label",11),r(24,"Sort By"),a(),i(25,"select",14),b("ngModelChange",function(s){return _(e.sortBy,s)||(e.sortBy=s),s}),u("change",function(s){return e.onSortChange(s.target.value)}),i(26,"option",15),r(27,"Descending"),a(),i(28,"option",16),r(29,"Ascending"),a()()(),i(30,"div",13)(31,"label",11),r(32,"Status"),a(),i(33,"select",14),b("ngModelChange",function(s){return _(e.status,s)||(e.status=s),s}),u("change",function(s){return e.onStatusChange(s.target.value)}),i(34,"option",17),r(35,"All"),a(),i(36,"option",18),r(37,"New"),a(),i(38,"option",19),r(39,"Active"),a(),i(40,"option",20),r(41,"Pending"),a(),i(42,"option",21),r(43,"Inactive"),a(),i(44,"option",22),r(45,"Completed"),a()()(),i(46,"div",13)(47,"button",23),u("click",function(){return e.applyFilters()}),p(48,"i",24),r(49," Search "),a()(),i(50,"div",13)(51,"button",25),u("click",function(){return e.clearFilters()}),p(52,"i",26),r(53," Clear "),a()()()(),i(54,"div",27),M(55,nt,6,0,"div",28)(56,rt,3,1,"div",29)(57,ot,4,0,"div",28)(58,lt,23,2,"table",30),a(),M(59,mt,5,3,"div",31),a()),n&2&&(m(8),d("routerLink",e.routes.homeNew),m(9),S("ngModel",e.fromDate),d("ngModelOptions",y(14,N)),m(4),S("ngModel",e.toDate),d("ngModelOptions",y(15,N)),m(4),S("ngModel",e.sortBy),d("ngModelOptions",y(16,N)),m(8),S("ngModel",e.status),d("ngModelOptions",y(17,N)),m(22),d("ngIf",e.isLoading),m(),d("ngIf",e.hasError),m(),d("ngIf",!e.isLoading&&!e.hasError&&e.totalData===0),m(),d("ngIf",!e.isLoading&&!e.hasError&&e.totalData>0),m(),d("ngIf",!e.isLoading&&!e.hasError&&e.totalData>0))},dependencies:[z,V,L,O,Y,q,R,U,J,H,G,K,Q,Z],encapsulation:2})}}return o})();var dt=[{path:"",component:it}],at=(()=>{class o{static{this.\u0275fac=function(n){return new(n||o)}}static{this.\u0275mod=x({type:o})}static{this.\u0275inj=E({imports:[I.forChild(dt),I]})}}return o})();var At=(()=>{class o{static{this.\u0275fac=function(n){return new(n||o)}}static{this.\u0275mod=x({type:o})}static{this.\u0275inj=E({imports:[F,at,$]})}}return o})();export{At as CustomersModule};
