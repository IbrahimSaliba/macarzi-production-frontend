import{a as de}from"./chunk-NRINXQYY.js";import{a as me}from"./chunk-ZHXSHU6C.js";import{Mc as ae,Nc as k,Pc as se,Qc as le,Tc as pe,bd as ue,wd as ce}from"./chunk-2BYPWJHQ.js";import"./chunk-WACMVKXJ.js";import"./chunk-2QSN2QZ4.js";import"./chunk-G2XYFENO.js";import"./chunk-A6GTVXL6.js";import{a as ee,i as te,j as ne,l as ie,n as re,o as oe}from"./chunk-KCCW6LK5.js";import{a as S}from"./chunk-KV7E3DUU.js";import{$ as L,$a as m,Ac as X,Cb as E,Eb as N,Fb as D,Gc as w,Ja as r,Kb as d,Mb as O,Oa as x,Qb as K,Rb as Q,Sb as $,Tb as W,Ub as q,W as B,Wa as C,Wc as Z,X as j,Xa as _,Xb as G,Y as g,Zc as V,_a as R,db as p,ga as f,ha as h,jc as Y,ka as F,oa as v,ob as s,pb as l,qb as y,rb as T,sb as b,tb as U,tc as H,ub as z,uc as J,vc as M,wb as I,xb as o}from"./chunk-MSHI2ENP.js";import"./chunk-EQDQRRRY.js";var ve=["input"],xe=(n,c,e)=>({$implicit:n,events:c,index:e});function Ce(n,c){if(n&1){let e=z();T(0),s(1,"input",2),I("input",function(i){f(e);let a=o().$implicit,u=o();return h(u.onInput(i,a-1))})("focus",function(i){f(e);let a=o(2);return h(a.onInputFocus(i))})("blur",function(i){f(e);let a=o(2);return h(a.onInputBlur(i))})("paste",function(i){f(e);let a=o(2);return h(a.onPaste(i))})("keydown",function(i){f(e);let a=o(2);return h(a.onKeyDown(i))}),l(),b()}if(n&2){let e=o().$implicit,t=o();r(),p("value",t.getModelValue(e))("maxLength",e===1?t.length:1)("type",t.inputType)("pSize",t.size)("variant",t.variant)("readonly",t.readonly)("disabled",t.disabled)("tabindex",t.tabindex)("pAutoFocus",t.getAutofocus(e))("ngClass",t.styleClass)}}function Te(n,c){n&1&&U(0)}function be(n,c){if(n&1&&(T(0),m(1,Te,1,0,"ng-container",3),b()),n&2){let e=o().$implicit,t=o();r(),p("ngTemplateOutlet",t.inputTemplate||t._inputTemplate)("ngTemplateOutletContext",G(2,xe,t.getToken(e-1),t.getTemplateEvents(e-1),e))}}function Ie(n,c){if(n&1&&(T(0),m(1,Ce,2,10,"ng-container",1)(2,be,2,6,"ng-container",1),b()),n&2){let e=o();r(),p("ngIf",!e.inputTemplate&&!e._inputTemplate),r(),p("ngIf",e.inputTemplate||e._inputTemplate)}}var Oe=({dt:n})=>`
.p-inputotp {
    display: flex;
    align-items: center;
    gap: 0.5rem;
}

.p-inputotp-input {
    text-align: center;
    width: 2.5rem;
}

.p-inputotp-input.p-inputtext-sm {
    text-align: center;
    width: ${n("inputotp.input.sm.width")};
}

.p-inputotp-input.p-inputtext-lg {
    text-align: center;
    width: ${n("inputotp.input.lg.width")};
}
`,Me={root:"p-inputotp p-component",pcInput:"p-inputotp-input"},ge=(()=>{class n extends se{name="inputotp";theme=Oe;classes=Me;static \u0275fac=(()=>{let e;return function(i){return(e||(e=F(n)))(i||n)}})();static \u0275prov=j({token:n,factory:n.\u0275fac})}return n})();var we={provide:ee,useExisting:B(()=>P),multi:!0},P=(()=>{class n extends le{invalid=!1;disabled=!1;readonly=!1;variant;tabindex=null;length=4;styleClass;mask=!1;integerOnly=!1;autofocus;size;onChange=new v;onFocus=new v;onBlur=new v;inputTemplate;templates;_inputTemplate;tokens=[];onModelChange=()=>{};onModelTouched=()=>{};value;get inputMode(){return this.integerOnly?"numeric":"text"}get inputType(){return this.mask?"password":"text"}_componentStyle=L(ge);ngAfterContentInit(){this.templates.forEach(e=>{switch(e.getType()){case"input":this._inputTemplate=e.template;break;default:this._inputTemplate=e.template;break}})}getToken(e){return this.tokens[e]}getTemplateEvents(e){return{input:t=>this.onInput(t,e),keydown:t=>this.onKeyDown(t),focus:t=>this.onFocus.emit(t),blur:t=>this.onBlur.emit(t),paste:t=>this.onPaste(t)}}onInput(e,t){let i=e.target.value;if(t===0&&i.length>1){this.handleOnPaste(i,e),e.stopPropagation();return}this.tokens[t]=i,this.updateModel(e),e.inputType==="deleteContentBackward"?this.moveToPrev(e):(e.inputType==="insertText"||e.inputType==="deleteContentForward")&&this.moveToNext(e)}updateModel(e){let t=this.tokens.join("");this.onModelChange(t),this.onChange.emit({originalEvent:e,value:t})}writeValue(e){e?Array.isArray(e)&&e.length>0?this.value=e.slice(0,this.length):this.value=e.toString().split("").slice(0,this.length):this.value=e,this.updateTokens(),this.cd.markForCheck()}updateTokens(){this.value!==null&&this.value!==void 0?Array.isArray(this.value)?this.tokens=[...this.value]:this.tokens=this.value.toString().split(""):this.tokens=[]}getModelValue(e){return this.tokens[e-1]||""}getAutofocus(e){return e===1?this.autofocus:!1}registerOnChange(e){this.onModelChange=e}registerOnTouched(e){this.onModelTouched=e}moveToPrev(e){let t=this.findPrevInput(e.target);t&&(t.focus(),t.select())}moveToNext(e){let t=this.findNextInput(e.target);t&&(t.focus(),t.select())}findNextInput(e){let t=e.nextElementSibling;if(t)return t.nodeName==="INPUT"?t:this.findNextInput(t)}findPrevInput(e){let t=e.previousElementSibling;if(t)return t.nodeName==="INPUT"?t:this.findPrevInput(t)}onInputFocus(e){e.target.select(),this.onFocus.emit(e)}onInputBlur(e){this.onBlur.emit(e)}onKeyDown(e){if(!(e.altKey||e.ctrlKey||e.metaKey))switch(e.code){case"ArrowLeft":this.moveToPrev(e),e.preventDefault();break;case"ArrowUp":case"ArrowDown":e.preventDefault();break;case"Backspace":e.target.value.length===0&&(this.moveToPrev(e),e.preventDefault());break;case"ArrowRight":this.moveToNext(e),e.preventDefault();break;default:(this.integerOnly&&!(Number(e.key)>=0&&Number(e.key)<=9)||this.tokens.join("").length>=this.length&&e.code!=="Delete")&&e.preventDefault();break}}onPaste(e){if(!this.disabled&&!this.readonly){let t=e.clipboardData.getData("text");t.length&&this.handleOnPaste(t,e),e.preventDefault()}}handleOnPaste(e,t){let i=e.substring(0,this.length+1);(!this.integerOnly||!isNaN(i))&&(this.tokens=i.split(""),this.updateModel(t))}getRange(e){return Array.from({length:e},(t,i)=>i+1)}trackByFn(e){return e}static \u0275fac=(()=>{let e;return function(i){return(e||(e=F(n)))(i||n)}})();static \u0275cmp=C({type:n,selectors:[["p-inputOtp"],["p-inputotp"],["p-input-otp"]],contentQueries:function(t,i,a){if(t&1&&(E(a,ve,4),E(a,ae,4)),t&2){let u;N(u=D())&&(i.inputTemplate=u.first),N(u=D())&&(i.templates=u)}},hostAttrs:[1,"p-inputotp","p-component"],inputs:{invalid:"invalid",disabled:"disabled",readonly:"readonly",variant:"variant",tabindex:"tabindex",length:"length",styleClass:"styleClass",mask:"mask",integerOnly:"integerOnly",autofocus:[2,"autofocus","autofocus",Y],size:"size"},outputs:{onChange:"onChange",onFocus:"onFocus",onBlur:"onBlur"},features:[W([we,ge]),R],decls:1,vars:2,consts:[[4,"ngFor","ngForOf","ngForTrackBy"],[4,"ngIf"],["type","text","pInputText","",1,"p-inputotp-input",3,"input","focus","blur","paste","keydown","value","maxLength","type","pSize","variant","readonly","disabled","tabindex","pAutoFocus","ngClass"],[4,"ngTemplateOutlet","ngTemplateOutletContext"]],template:function(t,i){t&1&&m(0,Ie,3,2,"ng-container",0),t&2&&p("ngForOf",i.getRange(i.length))("ngForTrackBy",i.trackByFn)},dependencies:[w,H,J,M,X,ue,pe,k],encapsulation:2,changeDetection:0})}return n})(),fe=(()=>{class n{static \u0275fac=function(t){return new(t||n)};static \u0275mod=_({type:n});static \u0275inj=g({imports:[P,k,k]})}return n})();var ke=()=>({standalone:!0});function Pe(n,c){n&1&&(s(0,"div",25)(1,"div",26)(2,"span",27),d(3,"Loading..."),l()(),s(4,"p",28),d(5,"Verifying OTP..."),l()())}function Fe(n,c){if(n&1&&(s(0,"div",29),d(1),l()),n&2){let e=o();r(),O(" ",e.errorMessage," ")}}function Ee(n,c){if(n&1&&(s(0,"div",30),d(1),l()),n&2){let e=o();r(),O(" ",e.successMessage," ")}}function Ne(n,c){n&1&&y(0,"span",31)}var he=(()=>{class n{constructor(e,t,i){this.router=e,this.apiService=t,this.authService=i,this.routes=S,this.username="",this.isLoading=!1,this.errorMessage="",this.successMessage=""}ngOnInit(){let e=this.authService.getUsername();e?this.username=e:(this.errorMessage="Session expired. Please login again.",setTimeout(()=>{this.router.navigate([S.adminlogin])},2e3))}directPage(){this.verifyOTP()}verifyOTP(){if(!this.value||this.value.toString().length!==4){this.errorMessage="Please enter a valid 4-digit OTP";return}this.isLoading=!0,this.errorMessage="",this.successMessage="";let e={username:this.username,otp:parseInt(this.value.toString())};this.apiService.verifyOTP(e).subscribe({next:t=>{this.isLoading=!1,t.errorCode==="000000"?(t.errorDescription&&(this.authService.setToken(t.errorDescription),this.apiService.getUserInfo(t.errorDescription).subscribe({next:i=>{i&&this.authService.setUserInfo(i)},error:i=>{console.error("Error fetching user info after OTP verification:",i)}})),this.successMessage="Verification successful!",setTimeout(()=>{this.router.navigate([S.adminDashboard])},1500)):this.errorMessage=t.errorDescription||t.message||"Verification failed"},error:t=>{this.isLoading=!1,t.error&&t.error.errorDescription?this.errorMessage=t.error.errorDescription:this.errorMessage="Verification failed. Please try again.",console.error("OTP verification error:",t)}})}resetotp(){this.value=null,this.errorMessage="",this.successMessage=""}static{this.\u0275fac=function(t){return new(t||n)(x(Z),x(me),x(de))}}static{this.\u0275cmp=C({type:n,selectors:[["app-otp"]],standalone:!1,decls:27,vars:10,consts:[[1,"container-fuild"],[1,"w-100","overflow-hidden","position-relative","flex-wrap","d-block","vh-100"],[1,"row","justify-content-center","align-items-center","vh-100","overflow-auto","flex-wrap"],[1,"col-lg-5","mx-auto"],[1,"digit-group","p-4",3,"ngSubmit"],[1,"mx-auto","mb-5","text-center"],["src","assets/img/logo-black.png","alt","Logo",1,"img-fluid"],[1,"card","authentication-card","mb-0"],[1,"card-body"],[1,"login-icon","bg-dark","d-flex","align-items-center","justify-content-center","mx-auto","mb-4"],[1,"ti","ti-mail","fs-24"],[1,"text-center","mb-3"],[1,"mb-1"],["class","text-center mt-3",4,"ngIf"],["class","alert alert-danger mt-3","role","alert",4,"ngIf"],["class","alert alert-success mt-3","role","alert",4,"ngIf"],[1,"text-center","otp-input"],[1,"d-flex","align-items-center","justify-content-center","mb-3"],[3,"ngModelChange","ngModel","integerOnly","ngModelOptions"],[1,"mt-3"],["type","submit",1,"btn","btn-dark","w-100",3,"disabled"],["class","spinner-border spinner-border-sm me-2","role","status",4,"ngIf"],[1,"login-bg"],["src","assets/admin/assets/img/bg/login-bg-01.png","alt","img",1,"login-bg-01"],["src","assets/admin/assets/img/bg/login-bg-02.png","alt","img",1,"login-bg-02"],[1,"text-center","mt-3"],["role","status",1,"spinner-border","text-primary"],[1,"visually-hidden"],[1,"mt-2"],["role","alert",1,"alert","alert-danger","mt-3"],["role","alert",1,"alert","alert-success","mt-3"],["role","status",1,"spinner-border","spinner-border-sm","me-2"]],template:function(t,i){t&1&&(s(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"form",4),I("ngSubmit",function(){return i.directPage()}),s(5,"div",5),y(6,"img",6),l(),s(7,"div",7)(8,"div",8)(9,"div",9),y(10,"i",10),l(),s(11,"div",11)(12,"h4",12),d(13,"Verify Your Email"),l(),m(14,Pe,6,0,"div",13)(15,Fe,2,1,"div",14)(16,Ee,2,1,"div",15),l(),s(17,"div",16)(18,"div",17)(19,"p-inputotp",18),$("ngModelChange",function(u){return Q(i.value,u)||(i.value=u),u}),l()()(),s(20,"div",19)(21,"button",20),m(22,Ne,1,0,"span",21),d(23),l()()()()()()()()(),s(24,"div",22),y(25,"img",23)(26,"img",24),l()),t&2&&(r(14),p("ngIf",i.isLoading),r(),p("ngIf",i.errorMessage),r(),p("ngIf",i.successMessage),r(3),K("ngModel",i.value),p("integerOnly",!0)("ngModelOptions",q(9,ke)),r(2),p("disabled",i.isLoading),r(),p("ngIf",i.isLoading),r(),O(" ",i.isLoading?"Verifying...":"Verify OTP"," "))},dependencies:[M,oe,te,ne,re,ie,P],styles:[".img-fluid[_ngcontent-%COMP%]{width:50%!important}"]})}}return n})();var De=[{path:"",component:he}],_e=(()=>{class n{static{this.\u0275fac=function(t){return new(t||n)}}static{this.\u0275mod=_({type:n})}static{this.\u0275inj=g({imports:[V.forChild(De),V]})}}return n})();var dt=(()=>{class n{static{this.\u0275fac=function(t){return new(t||n)}}static{this.\u0275mod=_({type:n})}static{this.\u0275inj=g({imports:[w,_e,ce,fe]})}}return n})();export{dt as OtpModule};
